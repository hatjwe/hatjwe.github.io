<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ” | Hexo</title>
  <meta name="keywords" content=" apikit ">
  <meta name="description" content="APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ” | Hexo">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ”æœ€è¿‘åœ¨åšä¸€äº›APIæ–‡æ¡£æ³„éœ²çš„å®‰å…¨è°ƒç ”ï¼Œçœ‹åˆ°ä¸€æ¬¾è‡ªåŠ¨æ£€æµ‹APIæ–‡æ¡£æ³„éœ²ï¼Œä¸”èƒ½æ¨¡æ‹Ÿæ¥å£å‘åŒ…çš„å·¥å…·ã€‚è§£æä¸‹æºç ï¼Œå‚è€ƒä¸‹å®ç°ã€‚ APIå®‰å…¨ç›¸å…³å·¥å…·åˆ†æï¼Œä¸»è¦æ£€æµ‹æ–¹é¢ä¸º 1234swaggerspring-boot actuatorgraphqlsoap  æºç åŠè°ƒè¯•APIKIT githubä¸Šæœ€æ–°relaseçš„æ˜¯jaråŒ…ï¼Œç»™çš„æºç è¿˜æ˜¯æ—§çš„ã€‚æœ€æ–°ç‰ˆå¯ä»¥ç”¨æˆ‘è¿™ä¸ªåç¼–è¯‘å†è¿˜åŸçš„ã€‚æºç åœ¨æœ€">
<meta property="og:type" content="article">
<meta property="og:title" content="APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ”">
<meta property="og:url" content="http://example.com/2025/02/20/API%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B-APIKIT%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ”æœ€è¿‘åœ¨åšä¸€äº›APIæ–‡æ¡£æ³„éœ²çš„å®‰å…¨è°ƒç ”ï¼Œçœ‹åˆ°ä¸€æ¬¾è‡ªåŠ¨æ£€æµ‹APIæ–‡æ¡£æ³„éœ²ï¼Œä¸”èƒ½æ¨¡æ‹Ÿæ¥å£å‘åŒ…çš„å·¥å…·ã€‚è§£æä¸‹æºç ï¼Œå‚è€ƒä¸‹å®ç°ã€‚ APIå®‰å…¨ç›¸å…³å·¥å…·åˆ†æï¼Œä¸»è¦æ£€æµ‹æ–¹é¢ä¸º 1234swaggerspring-boot actuatorgraphqlsoap  æºç åŠè°ƒè¯•APIKIT githubä¸Šæœ€æ–°relaseçš„æ˜¯jaråŒ…ï¼Œç»™çš„æºç è¿˜æ˜¯æ—§çš„ã€‚æœ€æ–°ç‰ˆå¯ä»¥ç”¨æˆ‘è¿™ä¸ªåç¼–è¯‘å†è¿˜åŸçš„ã€‚æºç åœ¨æœ€">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://prefect12.oss-cn-beijing.aliyuncs.com/2-17-1.png">
<meta property="og:image" content="https://prefect12.oss-cn-beijing.aliyuncs.com/2-18-1.png">
<meta property="og:image" content="https://prefect12.oss-cn-beijing.aliyuncs.com/2-12-1.png">
<meta property="og:image" content="https://prefect12.oss-cn-beijing.aliyuncs.com/2-13-2.png">
<meta property="og:image" content="https://prefect12.oss-cn-beijing.aliyuncs.com/2-13-3.png">
<meta property="og:image" content="https://prefect12.oss-cn-beijing.aliyuncs.com/2-13-9.png">
<meta property="og:image" content="https://prefect12.oss-cn-beijing.aliyuncs.com/25-2-13-7.png">
<meta property="og:image" content="https://prefect12.oss-cn-beijing.aliyuncs.com/2-14-1.png">
<meta property="article:published_time" content="2025-02-20T08:27:40.671Z">
<meta property="article:modified_time" content="2025-02-20T08:33:47.025Z">
<meta property="article:author" content="hatjwe">
<meta property="article:tag" content="apikit">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://prefect12.oss-cn-beijing.aliyuncs.com/2-17-1.png">


<link rel="icon" href="/img/avatar1.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar1.jpg"/>
</a>
<div class="author">
    <span>hatjwe</span>
</div>

<div class="icon">
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(10)</small>
            
        </div>
    </li>
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="äº‘å®‰å…¨">
            <i class="fold iconfont icon-right"></i>
            äº‘å®‰å…¨
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="äº‘å®‰å…¨&lt;---&gt;æºç æ³„éœ²">
            
            æºç æ³„éœ²
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="äº‘åŸç”Ÿ">
            <i class="fold iconfont icon-right"></i>
            äº‘åŸç”Ÿ
            <small>(4)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="äº‘åŸç”Ÿ&lt;---&gt;é•œåƒæ‰«æ">
            
            é•œåƒæ‰«æ
            <small>(2)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="äº‘åŸç”Ÿ&lt;---&gt;k8s">
            
            k8s
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="äº‘åŸç”Ÿ&lt;---&gt;RBAC">
            
            RBAC
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="ä¸»æœºå®‰å…¨">
            <i class="fold iconfont icon-right"></i>
            ä¸»æœºå®‰å…¨
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="ä¸»æœºå®‰å…¨&lt;---&gt;Capsule8">
            
            Capsule8
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="APIå®‰å…¨">
            <i class="fold iconfont icon-right"></i>
            APIå®‰å…¨
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="APIå®‰å…¨&lt;---&gt;æºç æ³„éœ²">
            
            æºç æ³„éœ²
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="DevOps">
            
            DevOps
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="linuxè¿ç»´">
            
            linuxè¿ç»´
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="10">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>é•œåƒæ‰«æ</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>æ—¥å¿—å®¡è®¡</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>agc</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>apikit</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Capsule8</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CI/CDå·¥å…·</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>linuxå‘½ä»¤</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RBAC</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="All APIå®‰å…¨ æºç æ³„éœ² "
           href="/2025/02/20/API%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B-APIKIT%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"
           data-tag="apikit"
           data-author="" >
            <span class="post-title" title="APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ”">APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ”</span>
            <span class="post-date" title="2025-02-20 16:27:40">2025/02/20</span>
        </a>
        
        
        <a  class="All äº‘å®‰å…¨ æºç æ³„éœ² "
           href="/2025/01/16/%E4%BA%91%E6%B3%84%E9%9C%B2/"
           data-tag="agc"
           data-author="" >
            <span class="post-title" title="äº‘æºç æ³„éœ²ç‚¹åˆ†æ">äº‘æºç æ³„éœ²ç‚¹åˆ†æ</span>
            <span class="post-date" title="2025-01-16 16:47:32">2025/01/16</span>
        </a>
        
        
        <a  class="All äº‘åŸç”Ÿ é•œåƒæ‰«æ "
           href="/2024/12/11/%E9%95%9C%E5%83%8F%E6%89%AB%E6%8F%8F-syft/"
           data-tag="é•œåƒæ‰«æ"
           data-author="" >
            <span class="post-title" title="é•œåƒæ‰«æ-syftåˆ†æ">é•œåƒæ‰«æ-syftåˆ†æ</span>
            <span class="post-date" title="2024-12-11 14:25:00">2024/12/11</span>
        </a>
        
        
        <a  class="All äº‘åŸç”Ÿ é•œåƒæ‰«æ "
           href="/2024/12/11/%E9%95%9C%E5%83%8F%E6%89%AB%E6%8F%8F-trivy/"
           data-tag="é•œåƒæ‰«æ"
           data-author="" >
            <span class="post-title" title="é•œåƒæ‰«æ-trivyåˆ†æ">é•œåƒæ‰«æ-trivyåˆ†æ</span>
            <span class="post-date" title="2024-12-11 14:12:46">2024/12/11</span>
        </a>
        
        
        <a  class="All DevOps "
           href="/2024/11/19/DevOps%E5%AE%9E%E8%B7%B5-CI/"
           data-tag="CI/CDå·¥å…·"
           data-author="" >
            <span class="post-title" title="DevOpså®è·µ-gitlab CIé›†æˆ">DevOpså®è·µ-gitlab CIé›†æˆ</span>
            <span class="post-date" title="2024-11-19 11:29:00">2024/11/19</span>
        </a>
        
        
        <a  class="All DevOps "
           href="/2024/11/06/DevOps%E5%AE%9E%E8%B7%B5/"
           data-tag="CI/CDå·¥å…·"
           data-author="" >
            <span class="post-title" title="DevOpså®è·µ-Watchtowerä¸€é”®å…¨è‡ªåŠ¨çš„watchtower">DevOpså®è·µ-Watchtowerä¸€é”®å…¨è‡ªåŠ¨çš„watchtower</span>
            <span class="post-date" title="2024-11-06 17:03:02">2024/11/06</span>
        </a>
        
        
        <a  class="All äº‘åŸç”Ÿ k8s "
           href="/2024/10/12/K8s%E6%97%A5%E5%BF%97%E5%AE%A1%E8%AE%A1%E8%B0%83%E7%A0%94/"
           data-tag="æ—¥å¿—å®¡è®¡"
           data-author="" >
            <span class="post-title" title="k8sæ—¥å¿—å®¡è®¡è°ƒç ”">k8sæ—¥å¿—å®¡è®¡è°ƒç ”</span>
            <span class="post-date" title="2024-10-12 16:47:26">2024/10/12</span>
        </a>
        
        
        <a  class="All linuxè¿ç»´ "
           href="/2024/10/09/%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA/"
           data-tag="linuxå‘½ä»¤"
           data-author="" >
            <span class="post-title" title="ç£ç›˜æŒ‚è½½åˆ†åŒº">ç£ç›˜æŒ‚è½½åˆ†åŒº</span>
            <span class="post-date" title="2024-10-09 11:56:07">2024/10/09</span>
        </a>
        
        
        <a  class="All äº‘åŸç”Ÿ RBAC "
           href="/2024/10/05/RBAC/"
           data-tag="RBAC"
           data-author="" >
            <span class="post-title" title="K8sä¹‹RBAC">K8sä¹‹RBAC</span>
            <span class="post-date" title="2024-10-05 21:49:22">2024/10/05</span>
        </a>
        
        
        <a  class="All ä¸»æœºå®‰å…¨ Capsule8 "
           href="/2024/10/05/ecaplute8/"
           data-tag="Capsule8"
           data-author="" >
            <span class="post-title" title="Capsule8åˆ†æ (ä¸€)">Capsule8åˆ†æ (ä¸€)</span>
            <span class="post-date" title="2024-10-05 21:49:22">2024/10/05</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-APIå®‰å…¨æ£€æµ‹-APIKITæºç è§£æ" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ”</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="APIå®‰å…¨">APIå®‰å…¨</a> > 
            
            <a  data-rel="APIå®‰å…¨&lt;---&gt;æºç æ³„éœ²">æºç æ³„éœ²</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color2">apikit</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2025-02-20 16:33:47'>2025-02-20 16:27</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            Views ğŸ‘€ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#API%E5%AE%89%E5%85%A8-%E6%96%87%E6%A1%A3%E6%B3%84%E9%9C%B2%E8%B0%83%E7%A0%94"><span class="toc-text">APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ”</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%8F%8A%E8%B0%83%E8%AF%95"><span class="toc-text">æºç åŠè°ƒè¯•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E5%BC%8F"><span class="toc-text">åŠ¨æ€è°ƒå¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6%E7%BC%96%E8%AF%91%E6%9B%BF%E6%8D%A2"><span class="toc-text">æ’ä»¶ç¼–è¯‘æ›¿æ¢</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API%E6%B3%84%E9%9C%B2%E6%A3%80%E6%B5%8B%E9%83%A8%E5%88%86"><span class="toc-text">APIæ³„éœ²æ£€æµ‹éƒ¨åˆ†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-swagger%E6%A3%80%E6%B5%8B"><span class="toc-text">1.1 swaggeræ£€æµ‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-%E7%89%B9%E5%BE%81%E5%8C%B9%E9%85%8D"><span class="toc-text">1.1.1 ç‰¹å¾åŒ¹é…</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urlAddPath-%E6%98%AF%E6%95%B4%E4%B8%AA%E5%A4%84%E7%90%86%E7%89%B9%E5%BE%81%E7%9A%84%E6%A0%B8%E5%BF%83%EF%BC%8C%E4%B8%8A%E4%B8%80%E6%AD%A5%E5%8F%AA%E6%98%AF%E6%8E%A2%E6%B5%8B%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8swagger%E9%A1%B5%E9%9D%A2-%E8%83%BD%E4%B8%8D%E8%83%BD%E6%8B%BF%E5%88%B0%E6%95%B0%E6%8D%AE%E8%BF%98%E5%BE%97%E7%9C%8B%E8%BF%99%E4%B8%80%E6%AD%A5-%E8%A7%A3%E6%9E%90%E7%89%B9%E5%BE%81%E6%96%B9%E6%B3%95%E5%A6%82%E4%B8%8B"><span class="toc-text">urlAddPath æ˜¯æ•´ä¸ªå¤„ç†ç‰¹å¾çš„æ ¸å¿ƒï¼Œä¸Šä¸€æ­¥åªæ˜¯æ¢æµ‹æ˜¯å¦å­˜åœ¨swaggeré¡µé¢,èƒ½ä¸èƒ½æ‹¿åˆ°æ•°æ®è¿˜å¾—çœ‹è¿™ä¸€æ­¥,è§£æç‰¹å¾æ–¹æ³•å¦‚ä¸‹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80-json-yaml%E5%BC%BA%E8%A7%A3%E6%9E%90"><span class="toc-text">æ–¹æ³•ä¸€  json&#x2F;yamlå¼ºè§£æ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%85%88%E5%BC%BA%E8%A7%A3%E6%9E%90json-%E4%B8%8D%E8%A1%8C%E5%86%8Dyaml%E7%84%B6%E5%90%8E%E8%BD%AC%E4%B8%BAjson"><span class="toc-text">ç¬¬ä¸€æ­¥ï¼šå…ˆå¼ºè§£æjson,ä¸è¡Œå†yamlç„¶åè½¬ä¸ºjson</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E5%A6%82%E6%9E%9C%E6%9C%89%E6%95%B0%E6%8D%AEjson%E5%88%86%E4%B8%A4%E7%A7%8D%E6%83%85%E5%86%B5%E6%A0%BC%E5%BC%8F-element-isJsonArray-%E5%92%8Celement-isJsonObject"><span class="toc-text">ç¬¬äºŒæ­¥ï¼šå¦‚æœæœ‰æ•°æ®jsonåˆ†ä¸¤ç§æƒ…å†µæ ¼å¼ element.isJsonArray()å’Œelement.isJsonObject()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C-%E6%AD%A3%E5%88%99url%E8%A7%A3%E6%9E%90"><span class="toc-text">æ–¹æ³•äºŒ æ­£åˆ™urlè§£æ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-%E6%96%87%E6%A1%A3%E8%A7%A3%E6%9E%90"><span class="toc-text">1.1.2 æ–‡æ¡£è§£æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-4-%E6%B5%8B%E8%AF%95%E6%95%88%E6%9E%9C"><span class="toc-text">1.1.4 æµ‹è¯•æ•ˆæœ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%A3%80%E6%B5%8Bspring-actuator"><span class="toc-text">1.2 æ£€æµ‹spring actuator</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-%E7%89%B9%E5%BE%81%E5%8C%B9%E9%85%8D"><span class="toc-text">1.2.1 ç‰¹å¾åŒ¹é…</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#actuator%E7%89%B9%E5%BE%81%E9%A1%B5%E9%9D%A2-%E6%B2%A1%E6%9C%89swagger%E5%A4%8D%E6%9D%82%EF%BC%8C%E4%BB%8E%E9%80%BB%E8%BE%91%E4%B8%8A%E7%9C%8B-%E5%B0%B1%E6%98%AF%E5%B0%86%E4%B8%8A%E8%BE%B9%E8%BE%93%E5%85%A5%E7%9A%84path%E9%87%8C%E8%BE%B9%E8%BF%9B%E8%A1%8C%E4%B8%80%E4%BA%9Bjson%E8%A7%A3%E6%9E%90%EF%BC%8C%E9%87%87%E9%9B%86%E5%88%B0%E4%BA%86%E5%AD%97%E6%AE%B5%E5%B0%B1%E8%AF%B4%E6%98%8E%E5%AD%98%E5%9C%A8%E6%B3%84%E9%9C%B2"><span class="toc-text">actuatorç‰¹å¾é¡µé¢,æ²¡æœ‰swaggerå¤æ‚ï¼Œä»é€»è¾‘ä¸Šçœ‹,å°±æ˜¯å°†ä¸Šè¾¹è¾“å…¥çš„pathé‡Œè¾¹è¿›è¡Œä¸€äº›jsonè§£æï¼Œé‡‡é›†åˆ°äº†å­—æ®µå°±è¯´æ˜å­˜åœ¨æ³„éœ²</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-%E6%96%87%E6%A1%A3%E8%A7%A3%E6%9E%90"><span class="toc-text">1.2.2 æ–‡æ¡£è§£æ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-soap%E6%A3%80%E6%B5%8B"><span class="toc-text">1.3 soapæ£€æµ‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-1-%E7%AE%80%E4%BB%8B"><span class="toc-text">1.3.1 ç®€ä»‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-2-%E7%89%B9%E5%BE%81%E5%8C%B9%E9%85%8D"><span class="toc-text">1.3.2 ç‰¹å¾åŒ¹é…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#urlAddPath%E5%87%BD%E6%95%B0%E6%B5%81%E7%A8%8B%E5%A6%82%E4%B8%8B"><span class="toc-text">urlAddPathå‡½æ•°æµç¨‹å¦‚ä¸‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E5%BE%811%EF%BC%8C%E4%BC%9A%E7%BB%99%E5%BD%93%E5%89%8Durl%E6%B7%BB%E5%8A%A0-wsdl%E4%BD%9C%E4%B8%BA%E4%B8%8B%E4%B8%80%E6%AD%A5%E7%9A%84%E8%A7%A3%E6%9E%90api%E6%96%87%E6%A1%A3%E8%B7%AF%E5%BE%84%EF%BC%8C%E7%89%B9%E5%BE%81%E4%BA%8C%E7%9A%84%E7%9B%AE%E6%A0%87%E9%A2%84%E8%AE%BE%E5%BA%94%E8%AF%A5%E4%B8%BAhtml%E6%96%87%E4%BB%B6%E9%80%9A%E8%BF%87%E6%AD%A3%E5%88%99%E6%8A%93%E5%8F%96soap%E6%96%87%E6%A1%A3%E5%9C%B0%E5%9D%80"><span class="toc-text">ç‰¹å¾1ï¼Œä¼šç»™å½“å‰urlæ·»åŠ ?wsdlä½œä¸ºä¸‹ä¸€æ­¥çš„è§£æapiæ–‡æ¡£è·¯å¾„ï¼Œç‰¹å¾äºŒçš„ç›®æ ‡é¢„è®¾åº”è¯¥ä¸ºhtmlæ–‡ä»¶é€šè¿‡æ­£åˆ™æŠ“å–soapæ–‡æ¡£åœ°å€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-3-%E6%96%87%E6%A1%A3%E8%A7%A3%E6%9E%90-%E6%A8%A1%E6%8B%9F%E5%8F%91%E5%8C%85"><span class="toc-text">1.3.3 æ–‡æ¡£è§£æ&#x2F;æ¨¡æ‹Ÿå‘åŒ…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-4-%E6%B5%8B%E8%AF%95%E6%95%88%E6%9E%9C"><span class="toc-text">1.3.4 æµ‹è¯•æ•ˆæœ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-graphql%E6%A3%80%E6%B5%8B"><span class="toc-text">1.4 graphqlæ£€æµ‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-1-%E7%AE%80%E4%BB%8B"><span class="toc-text">1.4.1 ç®€ä»‹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%85%E7%9C%81%E6%94%BB%E5%87%BB"><span class="toc-text">å†…çœæ”»å‡»</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-2-%E7%89%B9%E5%BE%81%E5%8C%B9%E9%85%8D"><span class="toc-text">1.4.2 ç‰¹å¾åŒ¹é…</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#urlAddPath%E7%89%B9%E5%BE%81%E9%80%BB%E8%BE%91%E4%B8%BB%E8%A6%81%E5%9C%A8%E8%BF%9B%E8%A1%8C%E5%86%85%E7%9C%81%E6%94%BB%E5%87%BB%EF%BC%8C%E6%9F%A5%E7%9C%8B%E8%AF%B7%E6%B1%82%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E6%B3%84%E9%9C%B2"><span class="toc-text">urlAddPathç‰¹å¾é€»è¾‘ä¸»è¦åœ¨è¿›è¡Œå†…çœæ”»å‡»ï¼ŒæŸ¥çœ‹è¯·æ±‚ç»“æœè¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³„éœ²</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-4-3-%E6%96%87%E6%A1%A3%E8%A7%A3%E6%9E%90"><span class="toc-text">1.4.3 æ–‡æ¡£è§£æ</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Kind-OBJECT%E7%B1%BB%E5%9E%8B"><span class="toc-text">Kind:OBJECTç±»å‹</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Kind-INTERFACE%E7%B1%BB%E5%9E%8B"><span class="toc-text">Kind:INTERFACEç±»å‹</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-4-4-%E6%A8%A1%E6%8B%9F%E8%AF%B7%E6%B1%82-%E5%8F%91%E5%8C%85"><span class="toc-text">1.4.4 æ¨¡æ‹Ÿè¯·æ±‚&#x2F;å‘åŒ…</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-4-%E6%B5%8B%E8%AF%95%E6%95%88%E6%9E%9C"><span class="toc-text">1.4.4 æµ‹è¯•æ•ˆæœ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-1-REST-WADL"><span class="toc-text">1.5.1  REST-WADL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-2-%E7%89%B9%E5%BE%81%E5%8C%B9%E9%85%8D"><span class="toc-text">1.5.2 ç‰¹å¾åŒ¹é…</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#urlAddPath%E4%B8%BB%E8%A6%81%E5%81%9A%E7%89%B9%E5%BE%81%E5%8C%B9%E9%85%8D-%E6%AD%A3%E5%88%99url%E8%A7%A3%E6%9E%90%E7%BD%91%E9%A1%B5%E5%93%8D%E5%BA%94%E6%B5%81%E9%87%8F%E4%B8%AD%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8wadl%E7%BD%91%E9%A1%B5%EF%BC%8C%E6%88%96%E8%80%85%E5%87%BA%E7%8E%B0"><span class="toc-text">urlAddPathä¸»è¦åšç‰¹å¾åŒ¹é… æ­£åˆ™urlè§£æç½‘é¡µå“åº”æµé‡ä¸­æ˜¯å¦å­˜åœ¨wadlç½‘é¡µï¼Œæˆ–è€…å‡ºç°&lt;application å¯èƒ½æ˜¯ç½‘é¡µæœ¬èº«å°±æ˜¯wadlæ–‡æ¡£</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-2%E6%96%87%E6%A1%A3%E8%A7%A3%E6%9E%90"><span class="toc-text">1.5.2æ–‡æ¡£è§£æ</span></a></li></ol></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ”"><a href="#APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ”" class="headerlink" title="APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ”"></a>APIå®‰å…¨-æ–‡æ¡£æ³„éœ²è°ƒç ”</h1><p>æœ€è¿‘åœ¨åšä¸€äº›APIæ–‡æ¡£æ³„éœ²çš„å®‰å…¨è°ƒç ”ï¼Œçœ‹åˆ°ä¸€æ¬¾è‡ªåŠ¨æ£€æµ‹APIæ–‡æ¡£æ³„éœ²ï¼Œä¸”èƒ½æ¨¡æ‹Ÿæ¥å£å‘åŒ…çš„å·¥å…·ã€‚è§£æä¸‹æºç ï¼Œå‚è€ƒä¸‹å®ç°ã€‚</p>
<p>APIå®‰å…¨ç›¸å…³å·¥å…·åˆ†æï¼Œä¸»è¦æ£€æµ‹æ–¹é¢ä¸º</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">swagger</span><br><span class="line">spring-boot actuator</span><br><span class="line">graphql</span><br><span class="line">soap</span><br></pre></td></tr></table></figure>

<h2 id="æºç åŠè°ƒè¯•"><a href="#æºç åŠè°ƒè¯•" class="headerlink" title="æºç åŠè°ƒè¯•"></a>æºç åŠè°ƒè¯•</h2><p>APIKIT githubä¸Šæœ€æ–°relaseçš„æ˜¯jaråŒ…ï¼Œç»™çš„æºç è¿˜æ˜¯æ—§çš„ã€‚æœ€æ–°ç‰ˆå¯ä»¥ç”¨æˆ‘è¿™ä¸ªåç¼–è¯‘å†è¿˜åŸçš„ã€‚<br>æºç åœ¨æœ€åº•ä¸‹é™„ä»¶</p>
<h3 id="åŠ¨æ€è°ƒå¼"><a href="#åŠ¨æ€è°ƒå¼" class="headerlink" title="åŠ¨æ€è°ƒå¼"></a>åŠ¨æ€è°ƒå¼</h3><p>javaæ”¯æŒåŠ¨æ€è°ƒå¼åŠŸèƒ½</p>
<h4 id="æ’ä»¶ç¼–è¯‘æ›¿æ¢"><a href="#æ’ä»¶ç¼–è¯‘æ›¿æ¢" class="headerlink" title="æ’ä»¶ç¼–è¯‘æ›¿æ¢"></a>æ’ä»¶ç¼–è¯‘æ›¿æ¢</h4><p><img src="https://prefect12.oss-cn-beijing.aliyuncs.com/2-17-1.png"><br>ç”¨å³è¾¹çš„Mavenå·¥å…·ï¼Œç›´æ¥installå³å¯ç”ŸæˆjaråŒ…ï¼Œç”¨è¿™ä¸ªåŠ è½½åˆ°burpé‡Œï¼Œåç»­æœ‰ä¿®æ”¹åŒç†installå†åŠ è½½ã€‚<br>è¿œç¨‹åŠ è½½debugã€‚å³ä½¿burpç”¨çš„javaç¯å¢ƒå’Œideaçš„javaç¯å¢ƒä¸ä¸€æ ·ä¹Ÿå¯ä»¥ã€‚<br>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/u014531320/article/details/140639053">https://blog.csdn.net/u014531320/article/details/140639053</a></p>
<p>éƒ¨ç½²å¥½debugç¯å¢ƒå°±å¯ä»¥å¼€å§‹ä¸‹é¢è§£æäº†.</p>
<p><img src="https://prefect12.oss-cn-beijing.aliyuncs.com/2-18-1.png"></p>
<h2 id="APIæ³„éœ²æ£€æµ‹éƒ¨åˆ†"><a href="#APIæ³„éœ²æ£€æµ‹éƒ¨åˆ†" class="headerlink" title="APIæ³„éœ²æ£€æµ‹éƒ¨åˆ†"></a>APIæ³„éœ²æ£€æµ‹éƒ¨åˆ†</h2><p>è¿™ä¸ªé¡¹ç›®æ˜¯åŸºäºburpæ’ä»¶åˆ¶ä½œï¼Œä¸»è¦åˆ†ä¸ºè¢«åŠ¨æµé‡æ‰«æå’Œä¸»åŠ¨ç‚¹å‡»ç›®æ ‡urlæ‰«æï¼Œè¿™ä¸¤ç§æ–¹å¼éƒ½æ˜¯åœ¨è°ƒç”¨this.apiScanner.detect ä¼ å…¥è°ƒç”¨burp sdkæ‹¿åˆ°çš„è¯·æ±‚æµé‡å’Œæ˜¯å¦ä¸ºè¢«åŠ¨æ‰«æçš„é€‰é¡¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#src/main/java/burp/PassiveScanner.java</span><br><span class="line">public List&lt;IScanIssue&gt; doPassiveScan(IHttpRequestResponse httpRequestResponse) &#123;</span><br><span class="line">        URL httpRequestURL = BurpExtender.getHelpers().analyzeRequest(httpRequestResponse).getUrl();</span><br><span class="line">        String requestUrl = CommonUtils.getUrlWithoutFilename(httpRequestURL);</span><br><span class="line">        if (this.scanedUrl.get(requestUrl) &lt;= 0) &#123;</span><br><span class="line">            this.scanedUrl.add(requestUrl);</span><br><span class="line">            System.out.println(&quot;Scanning\t&quot; + requestUrl);</span><br><span class="line">            ArrayList apiTypes = this.apiScanner.detect(httpRequestResponse, true);</span><br></pre></td></tr></table></figure>

<p>apiScanner.detectæ˜¯ä¸ªæ¥å£ï¼Œä¼šå…ˆåˆå§‹åŒ–å‡ ç§è¦æ‰«æçš„ç±»å‹å®ä¾‹ï¼Œç„¶åéå†è¿™äº›å®ä¾‹é€šè¿‡ apiType.isFingerprintMatch()çš„è¦†å†™æ–¹æ³•æ£€æµ‹æ˜¯å¦æœ‰é‚£äº›æ³„éœ²ç‰¹å¾ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#src/main/java/burp/application/ApiScanner.java</span><br><span class="line">public class ApiScanner &#123;</span><br><span class="line">    private final ArrayList&lt;BiFunction&lt;IHttpRequestResponse, Boolean, ApiType&gt;&gt; apiTypeConstructors = <span class="built_in">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    public ApiScanner() &#123;</span><br><span class="line">        this.apiTypeConstructors.add(ApiTypeActuator::newInstance);</span><br><span class="line">        this.apiTypeConstructors.add(ApiTypeSwagger::newInstance);</span><br><span class="line">        this.apiTypeConstructors.add(ApiTypeGraphQL::newInstance);</span><br><span class="line">        this.apiTypeConstructors.add(ApiTypeSoap::newInstance);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public ArrayList&lt;ApiType&gt; detect(IHttpRequestResponse baseRequestResponse, boolean isPassive) &#123;</span><br><span class="line">        ArrayList&lt;ApiType&gt; apiTypes = <span class="built_in">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (BiFunction&lt;IHttpRequestResponse, Boolean, ApiType&gt; apiTypeConstructor : apiTypeConstructors) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                ApiType apiType = apiTypeConstructor.apply(baseRequestResponse, isPassive);</span><br><span class="line">                <span class="keyword">if</span> (apiType.isFingerprintMatch()) &#123;</span><br><span class="line">                    apiTypes.add(apiType);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (Exception e) &#123;</span><br><span class="line">                BurpExtender.getStderr().<span class="built_in">println</span>(CommonUtils.exceptionToString(e));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> apiTypes;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-1-swaggeræ£€æµ‹"><a href="#1-1-swaggeræ£€æµ‹" class="headerlink" title="1.1 swaggeræ£€æµ‹"></a>1.1 swaggeræ£€æµ‹</h3><p><img src="https://prefect12.oss-cn-beijing.aliyuncs.com/2-12-1.png"></p>
<h4 id="1-1-1-ç‰¹å¾åŒ¹é…"><a href="#1-1-1-ç‰¹å¾åŒ¹é…" class="headerlink" title="1.1.1 ç‰¹å¾åŒ¹é…"></a>1.1.1 ç‰¹å¾åŒ¹é…</h4><p>è¿™éƒ¨åˆ†ä¸»è¦ç°æ˜¯å¯¹å¦‚æœç›®æ ‡æ˜¯swaggeræ—¶ï¼Œä¸€äº›ç‰¹å¾ç½‘é¡µè·¯å¾„è¿›è¡Œè®¿é—®æˆåŠŸå°±è¿›å…¥ç‰¹å¾åŒ¹é…ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#src/main/java/burp/application/apitypes/swagger/ApiTypeSwagger.java</span><br><span class="line">è·¯å¾„				 &quot;/swagger-resources&quot;</span><br><span class="line">								 &quot;/swagger/&quot;,</span><br><span class="line">                                    &quot;/swagger/index.html&quot;,</span><br><span class="line">                                    &quot;/api/&quot;,</span><br><span class="line">                                    &quot;/api/index.html&quot;,</span><br><span class="line">                                    &quot;/docs/&quot;,</span><br><span class="line">                                    &quot;/docs/index.html&quot;,</span><br><span class="line">                                    &quot;/apidocs/&quot;,</span><br><span class="line">                                    &quot;/apidocs/index.html&quot;,</span><br><span class="line">                                    &quot;/api-docs/&quot;,</span><br><span class="line">                                    &quot;/api-docs/index.html&quot;,</span><br><span class="line">                                    &quot;/&quot;</span><br><span class="line">public Boolean isFingerprintMatch() &#123;</span><br><span class="line">...</span><br><span class="line">                            for (String path : paths) &#123;</span><br><span class="line">                                Boolean checkResult = this.urlAddPath(urlPath + path);</span><br><span class="line">                                if (checkResult) &#123;</span><br><span class="line">                                    BurpExtender.PrintLog(&quot;Found Swagger at: &quot; + urlPath + path);</span><br><span class="line">                                    System.out.println(&quot;Found Swagger at: &quot; + urlPath + path); // è®°å½•æˆåŠŸè·¯å¾„</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="urlAddPath-æ˜¯æ•´ä¸ªå¤„ç†ç‰¹å¾çš„æ ¸å¿ƒï¼Œä¸Šä¸€æ­¥åªæ˜¯æ¢æµ‹æ˜¯å¦å­˜åœ¨swaggeré¡µé¢-èƒ½ä¸èƒ½æ‹¿åˆ°æ•°æ®è¿˜å¾—çœ‹è¿™ä¸€æ­¥-è§£æç‰¹å¾æ–¹æ³•å¦‚ä¸‹"><a href="#urlAddPath-æ˜¯æ•´ä¸ªå¤„ç†ç‰¹å¾çš„æ ¸å¿ƒï¼Œä¸Šä¸€æ­¥åªæ˜¯æ¢æµ‹æ˜¯å¦å­˜åœ¨swaggeré¡µé¢-èƒ½ä¸èƒ½æ‹¿åˆ°æ•°æ®è¿˜å¾—çœ‹è¿™ä¸€æ­¥-è§£æç‰¹å¾æ–¹æ³•å¦‚ä¸‹" class="headerlink" title="urlAddPath æ˜¯æ•´ä¸ªå¤„ç†ç‰¹å¾çš„æ ¸å¿ƒï¼Œä¸Šä¸€æ­¥åªæ˜¯æ¢æµ‹æ˜¯å¦å­˜åœ¨swaggeré¡µé¢,èƒ½ä¸èƒ½æ‹¿åˆ°æ•°æ®è¿˜å¾—çœ‹è¿™ä¸€æ­¥,è§£æç‰¹å¾æ–¹æ³•å¦‚ä¸‹"></a>urlAddPath æ˜¯æ•´ä¸ªå¤„ç†ç‰¹å¾çš„æ ¸å¿ƒï¼Œä¸Šä¸€æ­¥åªæ˜¯æ¢æµ‹æ˜¯å¦å­˜åœ¨swaggeré¡µé¢,èƒ½ä¸èƒ½æ‹¿åˆ°æ•°æ®è¿˜å¾—çœ‹è¿™ä¸€æ­¥,è§£æç‰¹å¾æ–¹æ³•å¦‚ä¸‹</h3><h5 id="æ–¹æ³•ä¸€-json-yamlå¼ºè§£æ"><a href="#æ–¹æ³•ä¸€-json-yamlå¼ºè§£æ" class="headerlink" title="æ–¹æ³•ä¸€  json&#x2F;yamlå¼ºè§£æ"></a>æ–¹æ³•ä¸€  json&#x2F;yamlå¼ºè§£æ</h5><p>æ‹¿åˆ°swaggeré¡µé¢å“åº”æµé‡ï¼Œå°è¯•è¿›è¡Œå¼ºè§£æï¼Œ</p>
<h5 id="ç¬¬ä¸€æ­¥ï¼šå…ˆå¼ºè§£æjson-ä¸è¡Œå†yamlç„¶åè½¬ä¸ºjson"><a href="#ç¬¬ä¸€æ­¥ï¼šå…ˆå¼ºè§£æjson-ä¸è¡Œå†yamlç„¶åè½¬ä¸ºjson" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šå…ˆå¼ºè§£æjson,ä¸è¡Œå†yamlç„¶åè½¬ä¸ºjson"></a>ç¬¬ä¸€æ­¥ï¼šå…ˆå¼ºè§£æjson,ä¸è¡Œå†yamlç„¶åè½¬ä¸ºjson</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># src/main/java/burp/application/apitypes/swagger/ApiTypeSwagger.java</span><br><span class="line"> public Boolean urlAddPath(String apiDocumentUrl) &#123;</span><br><span class="line"> ã€‚ã€‚ã€‚</span><br><span class="line"> 1.å…ˆå¼ºè§£æjson,ä¸è¡Œå†yamlç„¶åè½¬ä¸ºjson</span><br><span class="line">try &#123;</span><br><span class="line">                element = JsonParser.parseString(resp);</span><br><span class="line">            &#125; catch (Exception var24) &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            try &#123;</span><br><span class="line">                Yaml yaml = new Yaml(new SafeConstructor());</span><br><span class="line">                Object result = yaml.load(resp);</span><br><span class="line">                Gson gson = (new GsonBuilder()).create();</span><br><span class="line">                element = gson.toJsonTree(result);</span><br><span class="line">            &#125; catch (Exception var23) &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br></pre></td></tr></table></figure>

<h5 id="ç¬¬äºŒæ­¥ï¼šå¦‚æœæœ‰æ•°æ®jsonåˆ†ä¸¤ç§æƒ…å†µæ ¼å¼-element-isJsonArray-å’Œelement-isJsonObject"><a href="#ç¬¬äºŒæ­¥ï¼šå¦‚æœæœ‰æ•°æ®jsonåˆ†ä¸¤ç§æƒ…å†µæ ¼å¼-element-isJsonArray-å’Œelement-isJsonObject" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šå¦‚æœæœ‰æ•°æ®jsonåˆ†ä¸¤ç§æƒ…å†µæ ¼å¼ element.isJsonArray()å’Œelement.isJsonObject()"></a>ç¬¬äºŒæ­¥ï¼šå¦‚æœæœ‰æ•°æ®jsonåˆ†ä¸¤ç§æƒ…å†µæ ¼å¼ element.isJsonArray()å’Œelement.isJsonObject()</h5><p>isJsonArray())ç±»å‹æ•°æ®æ ·ä¾‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// /swagger-resources  openapi 2.x [&#123;&quot;name&quot;:&quot;default&quot;,&quot;location&quot;:&quot;/v2/api-docs&quot;,&quot;swaggerVersion&quot;:&quot;2.0&quot;&#125;]</span><br></pre></td></tr></table></figure>
<p>(1) isJsonArray())å¤„ç†é€»è¾‘ï¼Œå…³é”®åœ¨locationä¸­å–ï¼Œå–åˆ°çš„åŸºæœ¬ä¸Šå°±æ˜¯è¿™ä¸ªç½‘ç«™swagger.jsonçš„åœ°å€ï¼Œåœ¨urlAddPathå¤„ç†ä¸‹ç‰¹å¾</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#src/main/java/burp/application/apitypes/swagger/ApiTypeSwagger.java</span><br><span class="line"><span class="keyword">if</span> (element.isJsonArray()) &#123;</span><br><span class="line">                    JsonArray ja = element.getAsJsonArray();</span><br><span class="line">                    <span class="keyword">if</span> (null != ja) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (JsonElement ae : ja) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (ae.isJsonObject()) &#123;</span><br><span class="line">                                JsonObject link = ae.getAsJsonObject();</span><br><span class="line">                                <span class="comment">// openapi 1 2 3 éƒ½å¯ä»¥ä»locationä¸­å–ã€‚</span></span><br><span class="line">                                <span class="keyword">if</span> (!(link.get(<span class="string">&quot;location&quot;</span>) == null)) &#123;</span><br><span class="line">                                    try &#123;</span><br><span class="line">                                        String tmpurl = URLEncoder.encode(link.get(<span class="string">&quot;location&quot;</span>).getAsString(), <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">                                        tmpurl = tmpurl.replace(<span class="string">&quot;%2F&quot;</span>, <span class="string">&quot;/&quot;</span>).replace(<span class="string">&quot;%3D&quot;</span>, <span class="string">&quot;=&quot;</span>).replace(<span class="string">&quot;%3F&quot;</span>, <span class="string">&quot;?&quot;</span>).replace(<span class="string">&quot;%40&quot;</span>, <span class="string">&quot;@&quot;</span>).replace(<span class="string">&quot;%3A&quot;</span>, <span class="string">&quot;:&quot;</span>);</span><br><span class="line">                                        this.urlAddPath(urlPath + tmpurl);</span><br><span class="line">                                        this.urlAddPath(urlBasePath + tmpurl);</span><br><span class="line">                                    &#125; catch (UnsupportedEncodingException e) &#123;</span><br><span class="line">                                        BurpExtender.getStderr().<span class="built_in">println</span>(CommonUtils.exceptionToString(e));</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure>


<p>(2 ) isJsonObject()å¤„ç†é€»è¾‘,è¿™ä¸­å°±æ˜¯ç›´æ¥æ‹¿åˆ°swaggerçš„æ•°æ®é‡Œï¼Œä¾æ¬¡åŒ¹é…äº†pathsã€apiç­‰å­—æ®µæ¥ä¿è¯ä»–æ˜¯æ­£ç¡®æ•°æ®ï¼Œç„¶åthis.getApiDocuments().put(apiDocumentUrl, newHttpRequestResponse); æ”¾å…¥è¦è¿›è¡Œæ–‡æ¡£è§£æçš„æ•°ç»„é‡Œ</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#src/main/java/burp/application/apitypes/swagger/ApiTypeSwagger.java</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (element.isJsonObject()) &#123;</span><br><span class="line">                    JsonObject link = element.getAsJsonObject();</span><br><span class="line">                    <span class="keyword">if</span> (link.get(<span class="string">&quot;paths&quot;</span>) != null) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (link.get(<span class="string">&quot;paths&quot;</span>).isJsonObject() &amp;&amp; !this.getApiDocuments().containsKey(apiDocumentUrl)) &#123;</span><br><span class="line">                            this.getApiDocuments().put(apiDocumentUrl, newHttpRequestResponse);</span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (link.get(<span class="string">&quot;apis&quot;</span>) != null) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (link.get(<span class="string">&quot;basePath&quot;</span>) != null) &#123;</span><br><span class="line">                            isapiobject = <span class="literal">true</span>;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (link.get(<span class="string">&quot;apis&quot;</span>).isJsonArray()) &#123;</span><br><span class="line">                            JsonArray apisarray = link.get(<span class="string">&quot;apis&quot;</span>).getAsJsonArray();</span><br><span class="line">                            <span class="keyword">if</span> (null != apisarray) &#123;</span><br><span class="line">                                Iterator var37 = apisarray.iterator();</span><br><span class="line"></span><br><span class="line">                                while(var37.hasNext()) &#123;</span><br><span class="line">                                    JsonElement ae = (JsonElement)var37.next();</span><br><span class="line">                                    <span class="keyword">if</span> (ae.isJsonObject()) &#123;</span><br><span class="line">                                        JsonObject paths = ae.getAsJsonObject();</span><br><span class="line">                                        <span class="keyword">if</span> (paths.get(<span class="string">&quot;path&quot;</span>) != null) &#123;</span><br><span class="line">                                            <span class="keyword">if</span> (isapiobject) &#123;</span><br><span class="line">                                                <span class="keyword">if</span> (!this.getApiDocuments().containsKey(apiDocumentUrl)) &#123;</span><br><span class="line">                                                    this.getApiDocuments().put(apiDocumentUrl, newHttpRequestResponse);</span><br><span class="line">                                                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                                                &#125;</span><br><span class="line">                                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                                this.urlAddPath(CommonUtils.combineURLs(apiDocumentUrl, paths.get(<span class="string">&quot;path&quot;</span>).getAsString()));</span><br><span class="line">                                            &#125;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure>



<p>isJsonObjectç±»å‹çš„æ•°æ®æ ·ä¾‹</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /v2/api-docs  &#123;&quot;swagger&quot;:&quot;2.0&quot;,&quot;info&quot;:&#123;&quot;description&quot;:&quot;test&quot;,&quot;version&quot;:&quot;1.0&quot;,&quot;title&quot;:&quot;Java Swagger API æ–‡æ¡£&quot;,&quot;license&quot;:&#123;&#125;&#125;,&quot;host&quot;:&quot;0.0.0.0:8091&quot;,&quot;basePath&quot;:&quot;/&quot;,&quot;tags&quot;:[&#123;&quot;name&quot;:&quot;deserialize&quot;,&quot;description&quot;:&quot;Deserialize&quot;&#125;,&#123;&quot;name&quot;:&quot;filter-by-pass&quot;,&quot;description&quot;:&quot;Filter By Pass&quot;&#125;,&#123;&quot;name&quot;:&quot;user-controller&quot;,&quot;description&quot;:&quot;User Controller&quot;&#125;,&#123;&quot;name&quot;:&quot;commandi&quot;,&quot;description&quot;:&quot;Commandi&quot;&#125;],&quot;paths&quot;:&#123;&quot;/command/exec/array&quot;:&#123;&quot;post&quot;:&#123;&quot;tags&quot;:[&quot;commandi&quot;],&quot;summary&quot;:&quot;å‘½ä»¤æ‰§è¡Œ&quot;,&quot;description&quot;:&quot;execæ¥å—arrayå‚æ•°&quot;,&quot;operationId&quot;:&quot;execArrayUsingPOST&quot;,&quot;consumes&quot;:[&quot;application/json&quot;],&quot;produces&quot;:[&quot;application/json&quot;],&quot;parameters&quot;:[&#123;&quot;in&quot;:&quot;body&quot;,&quot;name&quot;:&quot;path&quot;,&quot;description&quot;:&quot;path&quot;,&quot;required&quot;:true,&quot;schema&quot;:&#123;&quot;$ref&quot;:&quot;#/definitions/</span></span><br><span class="line"><span class="comment">// /api-docs    &#123;&quot;apiVersion&quot;:&quot;1.0&quot;,&quot;apis&quot;:[&#123;&quot;description&quot;:&quot;Basic Error Controller&quot;,&quot;path&quot;:&quot;/default/basic-error-controller&quot;,&quot;position&quot;:0&#125;,&#123;&quot;description&quot;:&quot;Commandi&quot;,&quot;path&quot;:&quot;/default/commandi&quot;,&quot;position&quot;:0&#125;,&#123;&quot;description&quot;:&quot;Deserialize&quot;,&quot;path&quot;:&quot;/default/deserialize&quot;,&quot;position&quot;:0&#125;,&#123;&quot;description&quot;:&quot;Filter By Pass&quot;,&quot;path&quot;:&quot;/default/filter-by-pass&quot;,&quot;position&quot;:0&#125;,&#123;&quot;description&quot;:&quot;User Controller&quot;,&quot;path&quot;:&quot;/default/user-controller&quot;,&quot;position&quot;:0&#125;],&quot;authorizations&quot;:&#123;&#125;,&quot;info&quot;:&#123;&quot;contact&quot;:&quot;cor0ps&quot;,&quot;description&quot;:&quot;æ¼æ´ä»…ä»…åšå®‰å…¨ç ”ç©¶ä½¿ç”¨ï¼&quot;,&quot;title&quot;:&quot;Java Range API æ–‡æ¡£&quot;&#125;,&quot;swaggerVersion&quot;:&quot;1.2&quot;&#125;</span></span><br><span class="line">               &#125; </span><br></pre></td></tr></table></figure>
<h5 id="æ–¹æ³•äºŒ-æ­£åˆ™urlè§£æ"><a href="#æ–¹æ³•äºŒ-æ­£åˆ™urlè§£æ" class="headerlink" title="æ–¹æ³•äºŒ æ­£åˆ™urlè§£æ"></a>æ–¹æ³•äºŒ æ­£åˆ™urlè§£æ</h5><p>è¿™ä¸ªæ–¹æ³•å°±æ˜¯ä»æ‹¿åˆ°ç½‘ç«™çš„è¿”å›åŒ…ä¸­ï¼Œæ­£åˆ™åŒ¹é…ä¸¤ä¸ªç‰¹å¾æ¥æå–ä»–å¼•ç”¨æ•°æ®åœ°æ–¹çš„jsonè·¯å¾„</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#src/main/java/burp/application/apitypes/swagger/ApiTypeSwagger.java</span><br><span class="line">urlAddPath(String apiDocumentUrl)&#123;</span><br><span class="line"> <span class="comment">//æ­£åˆ™å»æ‹¿éjava swagger htmlä¸­çš„æ¥å£æ–‡æ¡£åœ°å€</span></span><br><span class="line">                Pattern pattern = Pattern.compile(<span class="string">&quot;url:(\\s*)\&quot;(.*?)\&quot;&quot;</span>);</span><br><span class="line">                Pattern pattern2 = Pattern.compile(<span class="string">&quot;discoveryPaths:(\\s*)arrayFrom\\(&#x27;(.*?)&#x27;\\)&quot;</span>);</span><br><span class="line">                Pattern pattern3 = Pattern.compile(<span class="string">&quot;\&quot;url\&quot;:(\\s*)\&quot;(.*?)\&quot;&quot;</span>);</span><br><span class="line">                Matcher matcher = pattern.matcher(resp);</span><br><span class="line">                Matcher matcher2 = pattern2.matcher(resp);</span><br><span class="line">                Matcher matcher3 = pattern3.matcher(resp);</span><br><span class="line">                String documentjsonyaml = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (documentjsonyaml.equals(<span class="string">&quot; &quot;</span>) || documentjsonyaml.isEmpty())</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        <span class="keyword">if</span> (documentjsonyaml.startsWith(<span class="string">&quot;./&quot;</span>))</span><br><span class="line">                            urlAddPath(apiDocumentUrl + (apiDocumentUrl.endsWith(<span class="string">&quot;/&quot;</span>) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;/&quot;</span>) + documentjsonyaml.substring(<span class="number">2</span>));</span><br><span class="line">                            <span class="comment">//å¦‚æœæ˜¯/å¼€å¤´è¯´æ˜å¯èƒ½æ˜¯python swagger  ä¸éœ€è¦åŠ /apidocs/è·¯å¾„</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> (documentjsonyaml.startsWith(<span class="string">&quot;/&quot;</span>)) &#123;</span><br><span class="line">                            urlAddPath(urlPath + documentjsonyaml);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (documentjsonyaml.startsWith(<span class="string">&quot;http&quot;</span>)) &#123;</span><br><span class="line">                            urlAddPath(documentjsonyaml);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (apiDocumentUrl.endsWith(<span class="string">&quot;/swagger/&quot;</span>))<span class="comment">//åƒbeegoçš„swagger åˆ™éœ€è¦åŠ ä¸Š/swagger/è·¯å¾„</span></span><br><span class="line">                            urlAddPath(apiDocumentUrl + documentjsonyaml);</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            <span class="comment">//         è‹¥æ˜¯æ ¹ç›®å½•ä¸å¸¦/  åˆ™åˆ¤æ–­åæ·»åŠ </span></span><br><span class="line">                            urlAddPath(urlPath + <span class="string">&quot;/&quot;</span> + documentjsonyaml);</span><br><span class="line">                    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="1-1-2-æ–‡æ¡£è§£æ"><a href="#1-1-2-æ–‡æ¡£è§£æ" class="headerlink" title="1.1.2 æ–‡æ¡£è§£æ"></a>1.1.2 æ–‡æ¡£è§£æ</h4><p>å¤„ç†è·å–åˆ°çš„swaggeræ•°æ®ç±»ä¼¼isJsonObjectçš„æ ·ä¾‹ï¼Œå¯¹openapi 1 2 3  swaggeræ ¹å¯¹è±¡åˆå§‹åŒ–ï¼Œæ ¹æ®ç‰¹å¾æ¯”å¦‚</p>
<ol>
<li><p>openapi 1.2 å’Œ2.0 éƒ½å¯ä»¥ç›´æ¥å–basePath  openapi3æ²¡æœ‰basePath</p>
</li>
<li><p>openapi3  basePathåœ¨ serversçš„urlä¸­ï¼Œurlå¦‚http:&#x2F;xxx&#x2F;v1 æ ¼å¼  å¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„  ä¹Ÿå¯ä»¥ä½¿ç”¨å˜é‡çš„å½¢å¼</p>
</li>
<li><p>å…·ä½“åœ¨ SwaggerParseObject()å‡½æ•°ä¸­å†™çš„éå¸¸è¯¦ç»†,è¿™é‡Œä»¥openApi 3.0.1æ ¼å¼ä¸ºä¾‹,ä¼šå°†æ‰€æœ‰pathsé‡Œçš„å†…å®¹è§£æä¸ºmap,ç„¶åéå†mapè¿›è¡Œæ¥ä¸‹æ¥çš„æ¨¡æ‹Ÿå™¨è¯·å¤„ç†</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#src/main/java/burp/application/apitypes/swagger/SwaggerObject.java</span><br><span class="line">public HashMap&lt;String, String&gt; SwaggerParseObject(JsonObject inputJsonobj, String _basePath) throws MalformedURLException &#123;</span><br><span class="line">       ...</span><br><span class="line">       <span class="keyword">if</span> (this.link.get(<span class="string">&quot;paths&quot;</span>) != null &amp;&amp; this.link.get(<span class="string">&quot;paths&quot;</span>).isJsonObject()) &#123;</span><br><span class="line">            JsonObject paths = this.link.get(<span class="string">&quot;paths&quot;</span>).getAsJsonObject();</span><br><span class="line">            Set&lt;Map.Entry&lt;String, JsonElement&gt;&gt; apiPaths = paths.getAsJsonObject().entrySet();</span><br><span class="line">            Iterator var19 = apiPaths.iterator();</span><br><span class="line"></span><br><span class="line">            label135:</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">   ![](https://prefect12.oss-cn-beijing.aliyuncs.com/2-12-2.png)</span><br><span class="line"></span><br><span class="line">#### 1.1.3 è¯·æ±‚æ¨¡æ‹Ÿ</span><br><span class="line"></span><br><span class="line">1. è¿™éƒ¨åˆ†ä¸»è¦æ˜¯æ ¹æ®ä¸Šä¸€æ­¥çš„æ•°æ®map å­—æ®µkey:apiè·¯å¾„ value:é‡Œè¾¹çš„å€¼å†…å®¹è¿›è¡Œè§£æï¼Œ3.0.1æ ¼å¼è§£æçš„å­—æ®µåŒ…æ‹¬parametersã€requestBodyä¿©éƒ¨åˆ†ã€‚</span><br><span class="line">2.  this.Openapi23ParserObjectä¼šå°†å­—æ®µå†…å®¹ç”Ÿæˆå¥½å¯¹è±¡ï¼Œæ–¹ä¾¿ this.makeHttpRequest(); </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p> #src&#x2F;main&#x2F;java&#x2F;burp&#x2F;application&#x2F;apitypes&#x2F;swagger&#x2F;SwaggerObject.java<br> if (((JsonElement)apiMethod.getValue()).getAsJsonObject().get(â€œparametersâ€) !&#x3D; null) {<br>                        reqparamnull &#x3D; false;<br>                        JsonArray apiParameters &#x3D; ((JsonElement)apiMethod.getValue()).getAsJsonObject().get(â€œparametersâ€).getAsJsonArray();<br>                        if (apiParameters.size() &#x3D;&#x3D; 0) {<br>                            reqparamnull &#x3D; true;<br>                        }</p>
<pre><code>                    if (null != apiParameters) &#123;
                        Iterator var28 = apiParameters.iterator();

                        while(var28.hasNext()) &#123;
                            JsonElement apiParameter = (JsonElement)var28.next();
                            if (!apiParameter.isJsonNull()) &#123;
                                this.params.clear();
                                this.in = &quot;&quot;;
                                this.Openapi23ParserObject(&quot;&quot;, apiParameter.getAsJsonObject()); //å¤„ç†æ•°æ®è½¬æ¢ä¸ºå¯¹è±¡
                                this.makeHttpRequest(); //æ ¹æ®ç±»å‹å¦‚parameters æ¨¡æ‹Ÿç”Ÿæˆå‚æ•°
                            &#125;
                        &#125;
                    &#125;
                &#125;
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">this.makeHttpRequest();  ä¸»è¦ç”¨äºæ¨¡æ‹Ÿåˆ¶é€ å‚æ•°ï¼Œæ¯”å¦‚æ•°æ®å°±ä¼šæ ¹æ®this.inçš„ç±»å‹æ¥æ¨¡æ‹Ÿç”Ÿæˆä»€ä¹ˆæ ·çš„å€¼ï¼Œé‚£ä¹ˆthis.inæ˜¯å¦‚ä½•ç”Ÿæˆçš„å‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line">â€‹```go</span><br><span class="line">#src/main/java/burp/application/apitypes/swagger/SwaggerObject.java</span><br><span class="line">switch (this.in) &#123;</span><br><span class="line">               ...</span><br><span class="line">                    case &quot;query&quot;:</span><br><span class="line">                        this.para_querystr = this.para_querystr + String.format(&quot;&amp;%s=%s&quot;, _para_name, replaceStr(_para_format));</span><br><span class="line">                        break;</span><br><span class="line">                    case &quot;formdata&quot;:</span><br><span class="line">                    case &quot;form&quot;:</span><br><span class="line">                        if (!this.isctset) &#123;</span><br><span class="line">                            this.isctset = true;</span><br><span class="line">                            this.newheaders.add(&quot;Content-Type: multipart/form-data; boundary=&quot; + this.boundary);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        if (_para_format.toLowerCase().contains(&quot;file&quot;)) &#123;</span><br><span class="line">                            this.para_bodystr = this.para_bodystr + &quot;--&quot; + this.boundary + &quot;\r\n&quot; + String.format(&quot;Content-Disposition: form-data; name=\&quot;%s\&quot;; filename=\&quot;tmp.jpg\&quot;&quot;, _para_name) + &quot;\r\n&quot; + &quot;Content-Type: application/octet-stream&quot; + &quot;\r\n&quot; + &quot;\r\n&quot; + &quot;GIF89aaaaaaaaaaaaaaaaaaaa&quot; + &quot;\r\n&quot;;</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                            this.para_bodystr = this.para_bodystr + &quot;--&quot; + this.boundary + &quot;\r\n&quot; + String.format(&quot;Content-Disposition: form-data; name=\&quot;%s\&quot;;&quot;, _para_name) + &quot;\r\n&quot; + &quot;\r\n&quot; + replaceStr(_para_format) + &quot;\r\n&quot;;</span><br><span class="line">                        &#125;</span><br><span class="line">                        break;</span><br><span class="line">                    case &quot;header&quot;:</span><br><span class="line">                        this.newheaders.add(_para_name + &quot;: &quot; + replaceStr(_para_format));</span><br><span class="line">                        break;</span><br><span class="line">                 </span><br><span class="line">        ],</span><br></pre></td></tr></table></figure>

<p>this.inä¸€èˆ¬æ˜¯å†ä¸Šä¸€æ­¥this.Openapi23ParserObjectè½¬æ¢ä¸ºå¯¹è±¡çš„è¿‡ç¨‹ä¸­ç”Ÿæˆçš„å…·ä½“é€»è¾‘å¦‚ä¸‹,è€Œä¸”ä¸åŒç‰ˆæœ¬çš„openapiç”¨åˆ°çš„è§£æOpenParserObjectä¹Ÿæ˜¯ä¸ä¸€æ ·çš„æœ‰å¥½å‡ ä¸ªã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#src/main/java/burp/application/apitypes/swagger/SwaggerObject.java</span><br><span class="line">private void Openapi23ParserObject(String para_name, JsonObject apiParam) &#123;</span><br><span class="line">     String para_format = &quot;&quot;;</span><br><span class="line">     String is_required = &quot;&quot;;</span><br><span class="line">     if (apiParam.get(&quot;name&quot;) != null) &#123;</span><br><span class="line">         para_name = apiParam.get(&quot;name&quot;).getAsString();</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     if (apiParam.get(&quot;in&quot;) != null) &#123;</span><br><span class="line">         this.in = apiParam.get(&quot;in&quot;).getAsString().toLowerCase();</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     if (apiParam.get(&quot;required&quot;) != null) &#123;</span><br><span class="line">         if (apiParam.get(&quot;required&quot;).isJsonPrimitive() &amp;&amp; apiParam.get(&quot;required&quot;).getAsBoolean()) &#123;</span><br><span class="line">             is_required = &quot;*&quot;;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125; else &#123;</span><br><span class="line">         is_required = &quot;&quot;;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-1-4-æµ‹è¯•æ•ˆæœ"><a href="#1-1-4-æµ‹è¯•æ•ˆæœ" class="headerlink" title="1.1.4 æµ‹è¯•æ•ˆæœ"></a>1.1.4 æµ‹è¯•æ•ˆæœ</h4><p>æµ‹è¯•ä¸­å­˜åœ¨ä¸€äº›é—®é¢˜æ¯”å¦‚swagger-ui-init.jsï¼ˆå¾ˆå°éƒ¨åˆ†ï¼Œä¸€èˆ¬æ˜¯çº¿ä¸Šæµ‹è¯•çš„ç¯å¢ƒï¼‰,è¿™ç§å…¶å®æ˜¯æµé‡è¿›æ¥çš„ï¼Œæ’ä»¶å¯¹å…¶æ£€æµ‹å¹¶æœªè§£æåˆ°å†…å®¹</p>
<p><img src="https://prefect12.oss-cn-beijing.aliyuncs.com/2-13-2.png"></p>
<p><img src="https://prefect12.oss-cn-beijing.aliyuncs.com/2-13-3.png"></p>
<h3 id="1-2-æ£€æµ‹spring-actuator"><a href="#1-2-æ£€æµ‹spring-actuator" class="headerlink" title="1.2 æ£€æµ‹spring actuator"></a>1.2 æ£€æµ‹spring actuator</h3><h4 id="1-2-1-ç‰¹å¾åŒ¹é…"><a href="#1-2-1-ç‰¹å¾åŒ¹é…" class="headerlink" title="1.2.1 ç‰¹å¾åŒ¹é…"></a>1.2.1 ç‰¹å¾åŒ¹é…</h4><p>åŒç†ä¸Šä¸€æ­¥ï¼Œè¿™å—æ˜¯spring actuatorä¸šåŠ¡ç±»çš„å®ç°é€»è¾‘ï¼Œurlç›®æ ‡è¿›æ¥ä¹Ÿæ˜¯å…ˆåŒ¹é…ç‰¹å¾</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#src/main/java/burp/application/apitypes/actuator/ApiTypeActuator.java</span><br><span class="line">public Boolean isFingerprintMatch() &#123;</span><br><span class="line"> while(var6.hasNext()) &#123;</span><br><span class="line">                        String urlPath = (String)var6.next();</span><br><span class="line">                        Boolean result = this.urlAddPath(urlPath + <span class="string">&quot;/actuator&quot;</span>);</span><br><span class="line">                        <span class="keyword">if</span> (result != null &amp;&amp; !result) &#123;</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/%61%63%74%75%61%74%6f%72&quot;</span>);</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/actuator.json&quot;</span>);</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/actuator;.js&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        result = this.urlAddPath(urlPath + <span class="string">&quot;/mappings&quot;</span>);</span><br><span class="line">                        <span class="keyword">if</span> (result != null &amp;&amp; !result) &#123;</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/%6d%61%70%70%69%6e%67%73&quot;</span>);</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/mappings.json&quot;</span>);</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/mappings;.js&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> this.getApiDocuments().size() != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="actuatorç‰¹å¾é¡µé¢-æ²¡æœ‰swaggerå¤æ‚ï¼Œä»é€»è¾‘ä¸Šçœ‹-å°±æ˜¯å°†ä¸Šè¾¹è¾“å…¥çš„pathé‡Œè¾¹è¿›è¡Œä¸€äº›jsonè§£æï¼Œé‡‡é›†åˆ°äº†å­—æ®µå°±è¯´æ˜å­˜åœ¨æ³„éœ²"><a href="#actuatorç‰¹å¾é¡µé¢-æ²¡æœ‰swaggerå¤æ‚ï¼Œä»é€»è¾‘ä¸Šçœ‹-å°±æ˜¯å°†ä¸Šè¾¹è¾“å…¥çš„pathé‡Œè¾¹è¿›è¡Œä¸€äº›jsonè§£æï¼Œé‡‡é›†åˆ°äº†å­—æ®µå°±è¯´æ˜å­˜åœ¨æ³„éœ²" class="headerlink" title="actuatorç‰¹å¾é¡µé¢,æ²¡æœ‰swaggerå¤æ‚ï¼Œä»é€»è¾‘ä¸Šçœ‹,å°±æ˜¯å°†ä¸Šè¾¹è¾“å…¥çš„pathé‡Œè¾¹è¿›è¡Œä¸€äº›jsonè§£æï¼Œé‡‡é›†åˆ°äº†å­—æ®µå°±è¯´æ˜å­˜åœ¨æ³„éœ²"></a>actuatorç‰¹å¾é¡µé¢,æ²¡æœ‰swaggerå¤æ‚ï¼Œä»é€»è¾‘ä¸Šçœ‹,å°±æ˜¯å°†ä¸Šè¾¹è¾“å…¥çš„pathé‡Œè¾¹è¿›è¡Œä¸€äº›jsonè§£æï¼Œé‡‡é›†åˆ°äº†å­—æ®µå°±è¯´æ˜å­˜åœ¨æ³„éœ²</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#src/main/java/burp/application/apitypes/actuator/ApiTypeActuator.java</span><br><span class="line">public Boolean urlAddPath(String apiDocumentUrl) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                JsonElement element = JsonParser.parseString(resp);</span><br><span class="line">                <span class="keyword">if</span> (element.isJsonObject()) &#123;</span><br><span class="line">                    JsonObject jsonObject = element.getAsJsonObject();</span><br><span class="line">                    <span class="keyword">if</span> (jsonObject.get(<span class="string">&quot;_links&quot;</span>) != null || jsonObject.get(<span class="string">&quot;/**/favicon.ico&quot;</span>) != null || jsonObject.get(<span class="string">&quot;contexts&quot;</span>) != null) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (jsonObject.get(<span class="string">&quot;_links&quot;</span>) != null &amp;&amp; jsonObject.get(<span class="string">&quot;_links&quot;</span>).getAsJsonObject().get(<span class="string">&quot;mappings&quot;</span>) != null) &#123;</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/mappings&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        this.getApiDocuments().put(apiDocumentUrl, newHttpRequestResponse);</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>


<h4 id="1-2-2-æ–‡æ¡£è§£æ"><a href="#1-2-2-æ–‡æ¡£è§£æ" class="headerlink" title="1.2.2 æ–‡æ¡£è§£æ"></a>1.2.2 æ–‡æ¡£è§£æ</h4><p>actuator çš„æ–‡æ¡£è§£æå’Œæ¨¡æ‹Ÿå‘åŒ…æ˜¯åœ¨ä¸€èµ·çš„ï¼Œé€šè¿‡ç•Œé¢UIå¼€å…³æ¥åˆ¤æ–­æ˜¯å¦å‘é€æ¨¡æ‹ŸåŒ…ï¼Œæ ¹æ®ä»£ç æ¥çœ‹ï¼Œä¸€èˆ¬éƒ½æ˜¯å†™getè¯·æ±‚æ²¡æœ‰æ¨¡æ‹Ÿå‚æ•°.</p>
<p>å¯¹æ–‡æ¡£è§£æä¸»è¦é€šè¿‡_links ã€&#x2F;**&#x2F;favicon.icoã€contextsç€æ‰‹ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">#src/main/java/burp/application/apitypes/actuator/ApiTypeActuator.java</span><br><span class="line">public ArrayList&lt;ApiEndpoint&gt; parseApiDocument(IHttpRequestResponse apiDocument, IHttpRequestResponse basePath, boolean isTargetScan) &#123;</span><br><span class="line"><span class="keyword">if</span> (jsonObject.get(<span class="string">&quot;_links&quot;</span>) != null) &#123;</span><br><span class="line">                    JsonObject links = jsonObject.get(<span class="string">&quot;_links&quot;</span>).getAsJsonObject();</span><br><span class="line">                        String uri = hrefUrl.getPath();</span><br><span class="line">                        <span class="keyword">if</span> (!path.contains(<span class="string">&quot;&#123;&quot;</span>) &amp;&amp; !path.contains(<span class="string">&quot;&#125;&quot;</span>)) &#123;</span><br><span class="line">                            try &#123;</span><br><span class="line">                                newRequest = this.helpers.buildHttpRequest(<span class="built_in">new</span> URL(path));</span><br><span class="line">                                <span class="keyword">if</span> (basePath == null) &#123;</span><br><span class="line">                                    newRequest = CookieManager.getRequest(apiDocument, newRequest);</span><br><span class="line">                                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    newRequest = CookieManager.getRequest(basePath, newRequest);</span><br><span class="line">                                &#125;</span><br><span class="line">                                ...</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    String href;</span><br><span class="line">                    <span class="keyword">if</span> (jsonObject.get(<span class="string">&quot;/**/favicon.ico&quot;</span>) != null) &#123;</span><br><span class="line">                        try &#123;</span><br><span class="line">                            Set&lt;Map.Entry&lt;String, JsonElement&gt;&gt; endpoints = jsonObject.entrySet();</span><br><span class="line">                            Iterator var31 = endpoints.iterator();</span><br><span class="line"></span><br><span class="line">                            while(var31.hasNext()) &#123;</span><br><span class="line">                                Map.Entry&lt;String, JsonElement&gt; endpoint = (Map.Entry)var31.next();</span><br><span class="line">                                href = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                path = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">                                try &#123;</span><br><span class="line">                                    Matcher matcher = pattern.matcher((CharSequence)endpoint.getKey());</span><br><span class="line">                                    <span class="keyword">if</span> (matcher.find()) &#123;</span><br><span class="line">                                        path = matcher.group().split(<span class="string">&quot; &quot;</span>)[<span class="number">0</span>];</span><br><span class="line">                                        path = path.endsWith(<span class="string">&quot;]&quot;</span>) ? path.substring(<span class="number">1</span>, path.length() - <span class="number">1</span>) : path.substring(<span class="number">1</span>);</span><br><span class="line">                                        <span class="keyword">if</span> (basePath == null) &#123;</span><br><span class="line">                                            href = CommonUtils.combineURLs(UrlWithoutFilename.substring(<span class="number">0</span>, UrlWithoutFilename.length() - <span class="number">1</span>), path);</span><br><span class="line">                                     ...</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (jsonObject.get(<span class="string">&quot;contexts&quot;</span>) != null) &#123;</span><br><span class="line">                        Matcher matcher = patternpath.matcher(body);</span><br><span class="line"></span><br><span class="line">                        String uri = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">                        while(matcher.find()) &#123;</span><br><span class="line">                            href = matcher.group(<span class="number">0</span>).replace(<span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                            <span class="keyword">if</span> (!href.endsWith(<span class="string">&quot;/&quot;</span>)) &#123;</span><br><span class="line">                                <span class="keyword">if</span> (basePath == null) &#123;</span><br><span class="line">                                    href = CommonUtils.combineURLs(UrlWithoutFilename.substring(<span class="number">0</span>, UrlWithoutFilename.length() - <span class="number">10</span>), href);</span><br><span class="line">                                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    href = CommonUtils.combineURLs(BaseURLPath, href);</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                                uri = href;</span><br><span class="line"></span><br><span class="line">                                try &#123;</span><br><span class="line">                                    newRequest = this.helpers.buildHttpRequest(<span class="built_in">new</span> URL(href));</span><br><span class="line">                                    <span class="keyword">if</span> (basePath == null) &#123;</span><br><span class="line">                                        newRequest = CookieManager.getRequest(apiDocument, newRequest);</span><br><span class="line">                                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                        newRequest = CookieManager.getRequest(basePath, newRequest);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                 ...</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-3-soapæ£€æµ‹"><a href="#1-3-soapæ£€æµ‹" class="headerlink" title="1.3 soapæ£€æµ‹"></a>1.3 soapæ£€æµ‹</h3><h4 id="1-3-1-ç®€ä»‹"><a href="#1-3-1-ç®€ä»‹" class="headerlink" title="1.3.1 ç®€ä»‹"></a>1.3.1 ç®€ä»‹</h4><p>SOAP æ˜¯åŸºäº XML çš„ç®€æ˜“åè®®ï¼Œå¯ä½¿åº”ç”¨ç¨‹åºåœ¨ HTTP ä¹‹ä¸Šè¿›è¡Œä¿¡æ¯äº¤æ¢ã€‚</p>
<p><a target="_blank" rel="noopener" href="http://52.209.189.24/VatatWebService.asmx?WSDL">http://52.209.189.24/VatatWebService.asmx?WSDL</a></p>
<p>SOAPç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p>
<p>SOAPæ¶ˆæ¯ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªSOAPæ¶ˆæ¯çš„æ¡†æ¶ï¼Œç”¨äºè¡¨è¾¾æ•°æ®å†…å®¹ã€‚<br>ä¸€æ¡SOAPæ¶ˆæ¯å°±æ˜¯ä¸€ä¸ªXMLæ–‡æ¡£ï¼ŒåŒ…å«ä»¥ä¸‹å…ƒç´ <br>Envelopeï¼šå¿…é¡»çš„ã€‚å®ƒSOAPæ¶ˆæ¯çš„æ ¹å…ƒç´ ã€‚å°±æ˜¯å®ƒæŠŠ XML æ–‡æ¡£å®šä¹‰ä¸º SOAP æ¶ˆæ¯ã€‚<br>Headerï¼šå¯é€‰çš„ã€‚å®ƒæ˜¯ä¸€ä¸ªæ‰©å±•ï¼Œå¯ç”¨äºåŒ…å«æœ‰å…³ SOAP æ¶ˆæ¯çš„åº”ç”¨ç¨‹åºçš„ä¸“ç”¨ä¿¡æ¯(æ¯”å¦‚èº«ä»½éªŒè¯ã€æ”¯ä»˜ç­‰)<br>Bodyï¼šå¿…é¡»çš„ã€‚å®ƒåŒ…å«SOAPæ¶ˆæ¯çš„æ­£æ–‡<br>Faultï¼šå¯é€‰çš„ã€‚å®ƒç”¨æ¥æºå¸¦é”™è¯¯æˆ–çŠ¶æ€ä¿¡æ¯</p>
<p>åœ¨å¹³å¸¸ä½¿ç”¨èµ°çš„æ˜¯SOAPåè®®æ—¶ï¼Œä¸€èˆ¬ç”¨æˆ·ï¼ˆæˆ–åå°ï¼‰ä¼šç»™ä½ ä¸€ä¸ªWSDLæ–‡ä»¶é‡Œè¾¹åŒ…å«xmlç›¸å…³çš„ä¿¡æ¯ã€‚</p>
<p>WSDLæ˜¯ä¸€ä¸ªç”¨äºç²¾ç¡®æè¿°WebæœåŠ¡çš„æ–‡æ¡£ï¼ŒWSDLæ–‡æ¡£æ˜¯ä¸€ä¸ªéµå¾ªWSDL-XMLæ¨¡å¼çš„XMLæ–‡æ¡£ã€‚WSDL æ–‡æ¡£å°†WebæœåŠ¡å®šä¹‰ä¸ºæœåŠ¡è®¿é—®ç‚¹æˆ–ç«¯å£çš„é›†åˆã€‚å› æ­¤åœ¨æ‰«æSOAPæ³„éœ²æ—¶ä¹Ÿä¼šæ‰¾æœåŠ¡å…³äºWSDLç‰¹å¾æ ‡å¿—ã€‚</p>
<p>æ¯”å¦‚ï¼š<br><img src="https://prefect12.oss-cn-beijing.aliyuncs.com/2-13-9.png"></p>
<p>å®ä¾‹ï¼š<a target="_blank" rel="noopener" href="http://52.209.189.24/VatatWebService.asmx?WSDL">http://52.209.189.24/VatatWebService.asmx?WSDL</a></p>
<h4 id="1-3-2-ç‰¹å¾åŒ¹é…"><a href="#1-3-2-ç‰¹å¾åŒ¹é…" class="headerlink" title="1.3.2 ç‰¹å¾åŒ¹é…"></a>1.3.2 ç‰¹å¾åŒ¹é…</h4><p>åŒæ ·è¿›æ¥çš„ç›®æ ‡ å…ˆé€šè¿‡ isFingerprintMatch()è¿‡æ»¤å­˜æ´»çš„ç‰¹å¾urlè·¯å¾„ï¼Œç„¶åè¿›å…¥urlAddPathè¿›è¡Œç‰¹å¾è§£æ</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># src/main/java/burp/application/apitypes/soap/ApiTypeSoap.java</span><br><span class="line">public Boolean isFingerprintMatch() &#123;</span><br><span class="line">        URL url = this.helpers.analyzeRequest(this.baseRequestResponse).getUrl();</span><br><span class="line">        ArrayList&lt;String&gt; urlList = <span class="built_in">new</span> ArrayList();</span><br><span class="line">        Set&lt;String&gt; UrlPathList = CommonUtils.getUrlPathList(url);</span><br><span class="line">        Iterator iterator = UrlPathList.iterator();</span><br><span class="line">        while(<span class="literal">true</span>) &#123;</span><br><span class="line">            String tmpurl;</span><br><span class="line">            do &#123;</span><br><span class="line">                <span class="keyword">if</span> (!iterator.hasNext()) &#123;</span><br><span class="line">                    this.urlAddPath(url.toString());</span><br><span class="line">                    Iterator var6 = urlList.iterator();</span><br><span class="line">                    while(var6.hasNext()) &#123;</span><br><span class="line">                        String urlPath = (String)var6.next();</span><br><span class="line">                        <span class="keyword">if</span> (!this.urlAddPath(urlPath + <span class="string">&quot;/service&quot;</span>)) &#123;</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/services&quot;</span>);</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/webservices&quot;</span>);</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/webservice&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> this.getApiDocuments().size() != <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="urlAddPathå‡½æ•°æµç¨‹å¦‚ä¸‹"><a href="#urlAddPathå‡½æ•°æµç¨‹å¦‚ä¸‹" class="headerlink" title="urlAddPathå‡½æ•°æµç¨‹å¦‚ä¸‹"></a>urlAddPathå‡½æ•°æµç¨‹å¦‚ä¸‹</h4><p><img src="https://prefect12.oss-cn-beijing.aliyuncs.com/25-2-13-7.png"></p>
<h4 id="ç‰¹å¾1ï¼Œä¼šç»™å½“å‰urlæ·»åŠ -wsdlä½œä¸ºä¸‹ä¸€æ­¥çš„è§£æapiæ–‡æ¡£è·¯å¾„ï¼Œç‰¹å¾äºŒçš„ç›®æ ‡é¢„è®¾åº”è¯¥ä¸ºhtmlæ–‡ä»¶é€šè¿‡æ­£åˆ™æŠ“å–soapæ–‡æ¡£åœ°å€"><a href="#ç‰¹å¾1ï¼Œä¼šç»™å½“å‰urlæ·»åŠ -wsdlä½œä¸ºä¸‹ä¸€æ­¥çš„è§£æapiæ–‡æ¡£è·¯å¾„ï¼Œç‰¹å¾äºŒçš„ç›®æ ‡é¢„è®¾åº”è¯¥ä¸ºhtmlæ–‡ä»¶é€šè¿‡æ­£åˆ™æŠ“å–soapæ–‡æ¡£åœ°å€" class="headerlink" title="ç‰¹å¾1ï¼Œä¼šç»™å½“å‰urlæ·»åŠ ?wsdlä½œä¸ºä¸‹ä¸€æ­¥çš„è§£æapiæ–‡æ¡£è·¯å¾„ï¼Œç‰¹å¾äºŒçš„ç›®æ ‡é¢„è®¾åº”è¯¥ä¸ºhtmlæ–‡ä»¶é€šè¿‡æ­£åˆ™æŠ“å–soapæ–‡æ¡£åœ°å€"></a>ç‰¹å¾1ï¼Œä¼šç»™å½“å‰urlæ·»åŠ ?wsdlä½œä¸ºä¸‹ä¸€æ­¥çš„è§£æapiæ–‡æ¡£è·¯å¾„ï¼Œç‰¹å¾äºŒçš„ç›®æ ‡é¢„è®¾åº”è¯¥ä¸ºhtmlæ–‡ä»¶é€šè¿‡æ­£åˆ™æŠ“å–soapæ–‡æ¡£åœ°å€</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"># src/main/java/burp/application/apitypes/soap/ApiTypeSoap.java</span><br><span class="line">public Boolean urlAddPath(String apiDocumentUrl) &#123;</span><br><span class="line">    <span class="comment">//ç‰¹å¾1</span></span><br><span class="line">     <span class="keyword">if</span> (resp.contains(<span class="string">&quot;soap:Server&quot;</span>) || resp.contains(<span class="string">&quot;xmlns:soap&quot;</span>)) &#123;</span><br><span class="line">                apidocument = currentUrl + (currentUrl.endsWith(<span class="string">&quot;/&quot;</span>) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;/&quot;</span>) + <span class="string">&quot;?wsdl&quot;</span>;</span><br><span class="line">                try &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!this.getApiDocuments().containsKey(apidocument)) &#123;</span><br><span class="line">                        newRequest = this.helpers.buildHttpRequest(<span class="built_in">new</span> URL(apidocument));</span><br><span class="line">                        newHttpRequestResponse = CookieManager.makeHttpRequest(this.baseRequestResponse, newRequest);</span><br><span class="line">                        this.getApiDocuments().put(apidocument, newHttpRequestResponse);</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (MalformedURLException var13) &#123;</span><br><span class="line">                    throw <span class="built_in">new</span> ApiKitRuntimeException(var13);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">//ç‰¹å¾2</span></span><br><span class="line">    resp = <span class="built_in">new</span> String(CommonUtils.getHttpResponseBody(newHttpRequestResponse.getResponse()));</span><br><span class="line">            Pattern pattern = Pattern.compile(<span class="string">&quot;href=\&quot;([^\&quot;]*)\\?wsdl\&quot;&gt;&quot;</span>);</span><br><span class="line">            Matcher matcher = pattern.matcher(resp);</span><br><span class="line"></span><br><span class="line">            while(matcher.find()) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    apidocument = matcher.group(<span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">if</span> (apidocument.startsWith(<span class="string">&quot;http&quot;</span>)) &#123;</span><br><span class="line">                        apidocument = apidocument + <span class="string">&quot;?wsdl&quot;</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        apidocument = this.helpers.analyzeRequest(newHttpRequestResponse).getUrl().toString() + (this.helpers.analyzeRequest(newHttpRequestResponse).getUrl().toString().endsWith(<span class="string">&quot;/&quot;</span>) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;/&quot;</span>) + apidocument + <span class="string">&quot;?wsdl&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (!this.getApiDocuments().containsKey(apidocument)) &#123;</span><br><span class="line">                        newRequest = this.helpers.buildHttpRequest(<span class="built_in">new</span> URL(apidocument));</span><br><span class="line">                        IHttpRequestResponse tempRequestResponse = CookieManager.makeHttpRequest(this.baseRequestResponse, newRequest);</span><br><span class="line">                        this.getApiDocuments().put(apidocument, tempRequestResponse);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (Exception var12) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-3-3-æ–‡æ¡£è§£æ-æ¨¡æ‹Ÿå‘åŒ…"><a href="#1-3-3-æ–‡æ¡£è§£æ-æ¨¡æ‹Ÿå‘åŒ…" class="headerlink" title="1.3.3 æ–‡æ¡£è§£æ&#x2F;æ¨¡æ‹Ÿå‘åŒ…"></a>1.3.3 æ–‡æ¡£è§£æ&#x2F;æ¨¡æ‹Ÿå‘åŒ…</h4><p>SOAPåœ¨ä»£ç ä¸­çœ‹åˆ°é¢å¤–æ·»åŠ äº†ä¸ªjaråŒ…ï¼Œåä¸ºsoa-model-core-1.6.4-SNAPSHOT-patched-jar-with-dependencies.jar ï¼Œåœ¨ä»£ç ä¸­çœ‹è¿™ä¸ªjaråŒ…ä¸»è¦åšçš„å°±æ˜¯ä¼ å…¥soapæ–‡æ¡£urlï¼Œå®ƒå»è§£ææ–‡æ¡£ï¼Œå¹¶ä¸”è‡ªå¸¦æ¨¡æ‹Ÿè¯·æ±‚æ–¹æ³•</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># src/main/java/burp/application/apitypes/soap/WsdlParser.java</span><br><span class="line">public static ArrayList&lt;ApiEndpoint&gt; parseWsdl(IHttpRequestResponse apiDocument, IHttpRequestResponse basePath, boolean isTargetScan) &#123;</span><br><span class="line">     <span class="comment">//ä¼ å…¥urlè§£æå†…å®¹  </span></span><br><span class="line">     WSDLParser parser = <span class="built_in">new</span> WSDLParser();</span><br><span class="line">      Definitions definitions = parser.parse(APIdocumenturl);</span><br><span class="line">     ...</span><br><span class="line">     <span class="comment">//æ¨¡æ‹Ÿè¯·æ±‚</span></span><br><span class="line">       try &#123;</span><br><span class="line">                            StringWriter writer = <span class="built_in">new</span> StringWriter();</span><br><span class="line">                            SOARequestCreator creator = <span class="built_in">new</span> SOARequestCreator(definitions, <span class="built_in">new</span> RequestTemplateCreator(), <span class="built_in">new</span> MarkupBuilder(writer));</span><br><span class="line">                            creator.createRequest(port.getName(), operation.getName(), port.getBinding().getName());</span><br><span class="line">                            List&lt;String&gt; tempHeaders = <span class="built_in">new</span> ArrayList(newHeaders);</span><br><span class="line">                            tempHeaders.add(<span class="string">&quot;SOAPAction: &quot;</span> + operation.getOperation().getSoapAction());</span><br><span class="line">                            <span class="keyword">if</span> (isTargetScan) &#123;</span><br><span class="line">                                HttpRequestFormator.TrimDupHeader(tempHeaders);</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                            apiRequest = helpers.buildHttpMessage(tempHeaders, writer.toString().getBytes());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                       ...</span><br><span class="line">                    &#125;</span><br><span class="line">                    tempRequestResponse.setRequest(apiRequest);</span><br><span class="line">                    tempRequestResponse.sendRequest();</span><br><span class="line">                    apiEndpoints.add(<span class="built_in">new</span> ApiEndpoint(operation.getName(), tempRequestResponse));</span><br><span class="line">                &#125;</span><br><span class="line">     </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-3-4-æµ‹è¯•æ•ˆæœ"><a href="#1-3-4-æµ‹è¯•æ•ˆæœ" class="headerlink" title="1.3.4 æµ‹è¯•æ•ˆæœ"></a>1.3.4 æµ‹è¯•æ•ˆæœ</h4><p>æµ‹è¯•ä¸­å‘ç°ä¼šæœ‰é—®é¢˜ï¼Œæ¯”å¦‚<a target="_blank" rel="noopener" href="http://52.209.189.24/VatatWebService.asmx?WSDL%E5%B7%B2%E7%BB%8F%E6%9C%89wsdl%E4%BA%86%EF%BC%8C%E4%BD%86%E6%98%AF%E8%BF%98%E4%BC%9A%E5%8A%A0%EF%BC%8C%E5%AF%BC%E8%87%B4%E8%A7%A3%E6%9E%90%E6%8A%A5%E9%94%99%EF%BC%8C%E5%9C%A8%E8%A7%A3%E6%9E%90%E6%96%87%E6%A1%A3%E8%BF%87%E7%A8%8B%E4%B8%AD%E5%8D%A1%E4%BD%8F%EF%BC%8C%E5%AF%BC%E8%87%B4%E5%90%8E%E8%BE%B9%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA%E5%A4%B1%E8%B4%A5%E3%80%82">http://52.209.189.24/VatatWebService.asmx?WSDLå·²ç»æœ‰wsdläº†ï¼Œä½†æ˜¯è¿˜ä¼šåŠ ï¼Œå¯¼è‡´è§£ææŠ¥é”™ï¼Œåœ¨è§£ææ–‡æ¡£è¿‡ç¨‹ä¸­å¡ä½ï¼Œå¯¼è‡´åè¾¹ç»“æœå±•ç¤ºå¤±è´¥ã€‚</a></p>
<p>åŸå› è¿˜æ˜¯ç‰¹å¾1å¯¹äºç›®æ ‡urlå¤„ç†æœ‰äº›ç®€å•ç²—æš´äº†,ä¸ç®¡æ˜¯å¦å·²ç»ä»¥wsdlç»“å°¾äº†ï¼Œè¿˜æ˜¯åŠ ä¸Š?wsdl</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apidocument = currentUrl + (currentUrl.endsWith(&quot;/&quot;) ? &quot;&quot; : &quot;/&quot;) + &quot;?wsdl&quot;;</span><br></pre></td></tr></table></figure>




<h3 id="1-4-graphqlæ£€æµ‹"><a href="#1-4-graphqlæ£€æµ‹" class="headerlink" title="1.4 graphqlæ£€æµ‹"></a>1.4 graphqlæ£€æµ‹</h3><h4 id="1-4-1-ç®€ä»‹"><a href="#1-4-1-ç®€ä»‹" class="headerlink" title="1.4.1 ç®€ä»‹"></a>1.4.1 ç®€ä»‹</h4><p>GraphQL æ˜¯ä¸€ç§ API æŸ¥è¯¢è¯­è¨€ï¼Œæ—¨åœ¨ä¿ƒè¿›å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é«˜æ•ˆé€šä¿¡ã€‚å®ƒä½¿ç”¨æˆ·èƒ½å¤Ÿå‡†ç¡®æŒ‡å®šä»–ä»¬åœ¨å“åº”ä¸­æ‰€éœ€çš„æ•°æ®ï¼Œä»è€Œæœ‰åŠ©äºé¿å…æœ‰æ—¶ä½¿ç”¨ REST API çœ‹åˆ°çš„å¤§å‹å“åº”å¯¹è±¡å’Œå¤šä¸ªè°ƒç”¨ã€‚</p>
<h5 id="å†…çœæ”»å‡»"><a href="#å†…çœæ”»å‡»" class="headerlink" title="å†…çœæ”»å‡»"></a>å†…çœæ”»å‡»</h5><p>å†…çœæ”»å‡»æ˜¯ä¸€ç§é’ˆå¯¹GraphQL APIçš„æ”»å‡»æ–¹æ³•ï¼Œåˆ©ç”¨äº†GraphQLçš„å†…çœèƒ½åŠ›ã€‚GraphQLçš„å†…çœï¼ˆintrospectionï¼‰æ˜¯æŒ‡é€šè¿‡ç‰¹å®šçš„æŸ¥è¯¢æ¥è·å–æœ‰å…³GraphQLæ¨¡å¼çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¯ç”¨çš„ç±»å‹ã€å­—æ®µã€å…³ç³»ç­‰ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å†…çœåŠŸèƒ½æ¥äº†è§£ç›®æ ‡GraphQL APIçš„ç»“æ„ï¼Œä»è€Œæ›´å¥½åœ°è¿›è¡Œåç»­æ”»å‡»ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„å†…çœæ”»å‡»æ–¹æ³•</p>
<p>ç®€çŸ­ç‚¹çš„</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> <span class="string">&quot;query&quot;</span>: <span class="string">&quot;&#123;__schema&#123;queryType&#123;name&#125;&#125;&#125;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¤æ‚ç‚¹çš„ï¼ŒåŠŸèƒ½éƒ½ä¸€æ ·</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;__schema&#123;queryType&#123;name&#125;mutationType&#123;name&#125;subscriptionType&#123;name&#125;types&#123;...FullType&#125;directives&#123;name description locations args&#123;...InputValue&#125;&#125;&#125;&#125;fragment FullType on __Type&#123;kind name description fields(includeDeprecated:<span class="literal">true</span>)&#123;name description args&#123;...InputValue&#125;<span class="keyword">type</span>&#123;...TypeRef&#125;isDeprecated deprecationReason&#125;inputFields&#123;...InputValue&#125;interfaces&#123;...TypeRef&#125;enumValues(includeDeprecated:<span class="literal">true</span>)&#123;name description isDeprecated deprecationReason&#125;possibleTypes&#123;...TypeRef&#125;&#125;fragment InputValue on __InputValue&#123;name description <span class="keyword">type</span>&#123;...TypeRef&#125;defaultValue&#125;fragment TypeRef on __Type&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>æ•ˆæœï¼Œå¯ä»¥ç†è§£å¦‚æœç›®æ ‡å¼€å¯äº†è¿™ä¸ªå†…çœæ¨¡å¼ï¼Œé€šè¿‡ä¸Šè¿°payloadå¯ä»¥çœ‹åˆ°ä»–å†™çš„æ‰€æœ‰qlå‚æ•°æŸ¥è¯¢å†…å®¹ç­‰ä¿¡æ¯</p>
<p><img src="https://prefect12.oss-cn-beijing.aliyuncs.com/2-14-1.png"></p>
<h4 id="1-4-2-ç‰¹å¾åŒ¹é…"><a href="#1-4-2-ç‰¹å¾åŒ¹é…" class="headerlink" title="1.4.2 ç‰¹å¾åŒ¹é…"></a>1.4.2 ç‰¹å¾åŒ¹é…</h4><p>åŒæ ·è¿›æ¥çš„ç›®æ ‡ å…ˆé€šè¿‡ isFingerprintMatch()è¿‡æ»¤å­˜æ´»çš„ç‰¹å¾urlè·¯å¾„ï¼Œç„¶åè¿›å…¥urlAddPathè¿›è¡Œç‰¹å¾è§£æ,ã€‚</p>
<p>TIPSï¼šé‚£ä¸ª&#x2F;æ ¹ç›®å½•æ˜¯æˆ‘åŠ çš„ï¼Œæµ‹è¯•ä¸­å‘ç°ä»–å¯¹è¿™ç§ç›´æ¥ç›®æ ‡æµ‹ä¸å‡ºæ¥ï¼Œä¾‹å¦‚urlä¸ºï¼š<a target="_blank" rel="noopener" href="http://nrep-graphql.numerous.cloud/">http://nrep-graphql.numerous.cloud/</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># src/main/java/burp/application/apitypes/graphql/ApiTypeGraphQL.java</span><br><span class="line">public Boolean isFingerprintMatch() &#123;</span><br><span class="line">    ...</span><br><span class="line">        while(<span class="literal">true</span>) &#123;</span><br><span class="line">            String tmpurl;</span><br><span class="line">            do &#123;</span><br><span class="line">                <span class="keyword">if</span> (!iterator.hasNext()) &#123;</span><br><span class="line">                    Iterator var6 = urlList.iterator();</span><br><span class="line"></span><br><span class="line">                    while(var6.hasNext()) &#123;</span><br><span class="line">                        String urlPath = (String)var6.next();</span><br><span class="line">                        this.urlAddPath(urlPath + <span class="string">&quot;/&quot;</span>);</span><br><span class="line">                        this.urlAddPath(urlPath + <span class="string">&quot;/graphql&quot;</span>);</span><br><span class="line">                        this.urlAddPath(urlPath + <span class="string">&quot;/%67%72%61%70%68%71%6c&quot;</span>);</span><br><span class="line">                        this.urlAddPath(urlPath + <span class="string">&quot;/graphql.php&quot;</span>);</span><br><span class="line">                        this.urlAddPath(urlPath + <span class="string">&quot;/graphiql&quot;</span>);</span><br><span class="line">                        this.urlAddPath(urlPath + <span class="string">&quot;/%67%72%61%70%68%69%71%6c&quot;</span>);</span><br><span class="line">                        this.urlAddPath(urlPath + <span class="string">&quot;/graphiql.php&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> this.getApiDocuments().size() != <span class="number">0</span>;</span><br><span class="line">                &#125;...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="urlAddPathç‰¹å¾é€»è¾‘ä¸»è¦åœ¨è¿›è¡Œå†…çœæ”»å‡»ï¼ŒæŸ¥çœ‹è¯·æ±‚ç»“æœè¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³„éœ²"><a href="#urlAddPathç‰¹å¾é€»è¾‘ä¸»è¦åœ¨è¿›è¡Œå†…çœæ”»å‡»ï¼ŒæŸ¥çœ‹è¯·æ±‚ç»“æœè¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³„éœ²" class="headerlink" title="urlAddPathç‰¹å¾é€»è¾‘ä¸»è¦åœ¨è¿›è¡Œå†…çœæ”»å‡»ï¼ŒæŸ¥çœ‹è¯·æ±‚ç»“æœè¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³„éœ²"></a>urlAddPathç‰¹å¾é€»è¾‘ä¸»è¦åœ¨è¿›è¡Œå†…çœæ”»å‡»ï¼ŒæŸ¥çœ‹è¯·æ±‚ç»“æœè¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³„éœ²</h5><p>å‡½æ•°æ¥æ”¶è¯·æ±‚åœ°å€ï¼Œé€šè¿‡POSTè¯·æ±‚ï¼Œbodyæºå¸¦base64ç¼–ç åçš„å­—ç¬¦ä¸²è¿›è¡Œè®¿é—®ï¼Œå¦‚æœè¿”å›200ï¼Œä¸”å†…å®¹ä¸­åŒ…å«dataæˆ–è€…__schemaè¡¨ç¤ºè¿”å›äº†æ‰€æœ‰å‚æ•°ï¼Œå­˜åœ¨æ³„éœ²ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># src/main/java/burp/application/apitypes/graphql/ApiTypeGraphQL.java</span><br><span class="line">public Boolean urlAddPath(String apiDocumentUrl) &#123;</span><br><span class="line">      ....</span><br><span class="line">        List&lt;String&gt; headers = this.helpers.analyzeRequest(newRequest).getHeaders();</span><br><span class="line">        List&lt;String&gt; httpFirstLine = Arrays.asList(((String)headers.get(<span class="number">0</span>)).split(<span class="string">&quot; &quot;</span>));</span><br><span class="line">        httpFirstLine.set(<span class="number">0</span>, <span class="string">&quot;POST&quot;</span>);</span><br><span class="line">        headers.set(<span class="number">0</span>, String.join(<span class="string">&quot; &quot;</span>, httpFirstLine));</span><br><span class="line">        headers.add(<span class="string">&quot;Content-Type: application/json&quot;</span>);</span><br><span class="line">        JsonObject jsonBody = <span class="built_in">new</span> JsonObject();</span><br><span class="line">        IExtensionHelpers var10006 = this.helpers;</span><br><span class="line">        this.getClass();</span><br><span class="line">        jsonBody.add(<span class="string">&quot;query&quot;</span>, <span class="built_in">new</span> JsonPrimitive(<span class="built_in">new</span> String(var10006.base64Decode(<span class="string">&quot;xxx&quot;</span>))));</span><br><span class="line">        newRequest = this.helpers.buildHttpMessage(headers, (<span class="built_in">new</span> Gson()).toJson(jsonBody).getBytes());</span><br><span class="line">        IHttpRequestResponse newHttpRequestResponse = CookieManager.makeHttpRequest(this.baseRequestResponse, newRequest);</span><br><span class="line">        String Respone=newHttpRequestResponse.getResponse().toString();</span><br><span class="line">        <span class="keyword">if</span> (this.helpers.analyzeResponse(newHttpRequestResponse.getResponse()).getStatusCode() == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (this.isPassive) &#123;</span><br><span class="line">                <span class="keyword">if</span> (scannedUrl.get(this.helpers.analyzeRequest(newHttpRequestResponse).getUrl().toString()) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                scannedUrl.add(this.helpers.analyzeRequest(newHttpRequestResponse).getUrl().toString());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            String responseJSON = <span class="built_in">new</span> String(CommonUtils.getHttpResponseBody(newHttpRequestResponse.getResponse()));</span><br><span class="line"></span><br><span class="line">            try &#123;</span><br><span class="line">                JsonElement element = JsonParser.parseString(responseJSON);</span><br><span class="line">                <span class="keyword">if</span> (element.isJsonObject()) &#123;</span><br><span class="line">                    JsonObject jsonObject = element.getAsJsonObject();</span><br><span class="line">                    <span class="keyword">if</span> (!jsonObject.get(<span class="string">&quot;data&quot;</span>).isJsonNull() &amp;&amp; !jsonObject.get(<span class="string">&quot;data&quot;</span>).getAsJsonObject().get(<span class="string">&quot;__schema&quot;</span>).isJsonNull()) &#123;</span><br><span class="line">                        this.getApiDocuments().put(apiDocumentUrl, newHttpRequestResponse);</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (Exception var11) &#123;</span><br><span class="line">                System.out.<span class="built_in">println</span>(var11.getMessage());</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆbase64ç¼–ç å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿç»è¿‡è§£ç åå‘ç°å°±æ˜¯ä¸€ä¸ªå†…çœæ”»å‡»çš„payload,ä»ä»£ç é‡Œè°ƒå¼åæ‰£å‡ºæ¥çš„å®Œæ•´è¯·æ±‚åŒ…å¦‚ä¸‹ï¼š</p>
<p>æ€è€ƒï¼šä»ç½‘ä¸Šå‚è€ƒpayloadæœ‰ä¸‰ç§ï¼Œå¯ä»¥æ”¹ä¸ºæ¯æ¬¡æµ‹è¯•ä¸‰ä¸ªpayloadï¼Œé˜²æ­¢ä¸€ä¸ªpayloadç”±äºç½‘ç«™å…¼å®¹æ€§é—®é¢˜æ¼æŠ¥</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/<span class="number">1.1</span></span><br><span class="line">Host: nrep-graphql.numerous.cloud</span><br><span class="line">Content-Length: <span class="number">1555</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">133.0</span><span class="number">.0</span><span class="number">.0</span> Safari/<span class="number">537.36</span></span><br><span class="line">accept: application/json, multipart/mixed</span><br><span class="line">content-<span class="keyword">type</span>: application/json</span><br><span class="line">Origin: http:<span class="comment">//nrep-graphql.numerous.cloud</span></span><br><span class="line">Referer: http:<span class="comment">//nrep-graphql.numerous.cloud/</span></span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=<span class="number">0.9</span></span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">&quot;query&quot;</span>:<span class="string">&quot;query Query &#123;\n    __schema &#123;\n      queryType &#123; name &#125;\n      mutationType &#123; name &#125;\n      subscriptionType &#123; name &#125;\n      types &#123;\n        ...FullType\n      &#125;\n      directives &#123;\n        name\n        description\n        locations\n        args &#123;\n          ...InputValue\n        &#125;\n      &#125;\n    &#125;\n  &#125;\n\n  fragment FullType on __Type &#123;\n    kind\n    name\n    description\n    fields(includeDeprecated: true) &#123;\n      name\n      description\n      args &#123;\n        ...InputValue\n      &#125;\n      type &#123;\n        ...TypeRef\n      &#125;\n      isDeprecated\n      deprecationReason\n    &#125;\n    inputFields &#123;\n      ...InputValue\n    &#125;\n    interfaces &#123;\n      ...TypeRef\n    &#125;\n    enumValues(includeDeprecated: true) &#123;\n      name\n      description\n      isDeprecated\n      deprecationReason\n    &#125;\n    possibleTypes &#123;\n      ...TypeRef\n    &#125;\n  &#125;\n\n  fragment InputValue on __InputValue &#123;\n    name\n    description\n    type &#123; ...TypeRef &#125;\n    defaultValue\n  &#125;\n\n  fragment TypeRef on __Type &#123;\n    kind\n    name\n    ofType &#123;\n      kind\n      name\n      ofType &#123;\n        kind\n        name\n        ofType &#123;\n          kind\n          name\n          ofType &#123;\n            kind\n            name\n            ofType &#123;\n              kind\n              name\n              ofType &#123;\n                kind\n                name\n                ofType &#123;\n                  kind\n                  name\n                &#125;\n              &#125;\n            &#125;\n          &#125;\n        &#125;\n      &#125;\n    &#125;\n  &#125;&quot;</span>,<span class="string">&quot;operationName&quot;</span>:<span class="string">&quot;Query&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-4-3-æ–‡æ¡£è§£æ"><a href="#1-4-3-æ–‡æ¡£è§£æ" class="headerlink" title="1.4.3 æ–‡æ¡£è§£æ"></a>1.4.3 æ–‡æ¡£è§£æ</h5><p>è¿™è¾¹çš„é€»è¾‘è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œå…ˆæ¢³ç†ä¸€ä¸‹æ–‡æ¡£å†…å®¹ï¼Œé¦–å…ˆæ˜¯æ•°æ®é‡Œçš„typeså­—æ®µï¼Œè¡¨ç¤ºæ•°æ®çš„ç±»å‹</p>
<p>å†ç»†åˆ†ä¸‹ï¼Œä¸‹ä¸€æ­¥è¦å…³æ³¨çš„æ˜¯kindå­—æ®µï¼Œæ ¹æ®kindå­—æ®µæˆ‘ä»¬å¯ä»¥çŸ¥é“å®ƒå®šä¹‰äº†ä»€ä¹ˆï¼Œä»¥åŠæ€ä¹ˆåšçš„ã€‚</p>
<p>GraphQL çš„ typesä¸‹çš„<code>kind</code> ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ç±»å‹ï¼š</p>
<ul>
<li><p><strong>OBJECT</strong>ï¼šå¯¹è±¡ç±»å‹</p>
</li>
<li><p><strong>INTERFACE</strong>ï¼šæ¥å£ç±»å‹</p>
</li>
<li><p><strong>UNION</strong>ï¼šè”åˆç±»å‹</p>
</li>
<li><p><strong>SCALAR</strong>ï¼šæ ‡é‡ç±»å‹</p>
</li>
<li><p><strong>ENUM</strong>ï¼šæšä¸¾ç±»å‹</p>
</li>
<li><p><strong>INPUT_OBJECT</strong>ï¼šè¾“å…¥å¯¹è±¡ç±»å‹</p>
</li>
<li><p><strong>LIST</strong>ï¼šåˆ—è¡¨ç±»å‹</p>
</li>
<li><p><strong>NON_NULL</strong>ï¼šéç©ºç±»å‹</p>
</li>
<li><p><strong>è‡ªå®šä¹‰ SCALAR</strong>ï¼šè‡ªå®šä¹‰æ ‡é‡ç±»å‹</p>
<p>å¯å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/nEEia2VZgn6pDn4gZMUxsA">https://mp.weixin.qq.com/s/nEEia2VZgn6pDn4gZMUxsA</a></p>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;__schema&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;queryType&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Query&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;mutationType&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Mutation&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;subscriptionType&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Subscription&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;types&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;kind&quot;</span>: <span class="string">&quot;OBJECT&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Query&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;description&quot;</span>: null,</span><br><span class="line">                    <span class="string">&quot;fields&quot;</span>: [</span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»£ç å¯è§è§£ææ–‡æ¡£é¦–å…ˆé€šè¿‡è§£ætypeå­—æ®µï¼Œç„¶åå¯¹é‡Œè¾¹kindå­—æ®µçš„å†…å®¹è¿›è¡Œåˆ†ç±»ï¼Œç„¶åèµ°å…·ä½“çš„è§£æå­—æ®µçš„ã€‚ä¸‹é¢æŒ‘å‡ ä¸ªå¸¸ç”¨çš„å­—æ®µè¿›è¡Œè§£æ</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">src/main/java/burp/application/apitypes/graphql/GraphQLIntrospectionParser.java</span><br><span class="line">GraphQLParseResult parseIntrospection(String introspectionJson) &#123;</span><br><span class="line">JsonArray types = introspection.getAsJsonArray(<span class="string">&quot;types&quot;</span>);</span><br><span class="line">        HashMap&lt;String, GraphQLBaseObject&gt; globalObjects = <span class="built_in">new</span> HashMap&lt;&gt;();</span><br><span class="line">        GraphQLParseContext context = <span class="built_in">new</span> GraphQLParseContext(globalObjects);</span><br><span class="line">        <span class="comment">// è§£æ GraphQL è‡ªçœå¾—åˆ°çš„å„ç§ç±»/æ¥å£ç­‰ç­‰</span></span><br><span class="line">        <span class="keyword">for</span> (JsonElement element : types) &#123;</span><br><span class="line">            JsonObject object = element.getAsJsonObject();</span><br><span class="line">            GraphQLKind objectKind = GraphQLKind.valueOf(object.getAsJsonPrimitive(<span class="string">&quot;kind&quot;</span>).getAsString());</span><br><span class="line">            String name = object.getAsJsonPrimitive(<span class="string">&quot;name&quot;</span>).getAsString();</span><br><span class="line">            <span class="keyword">switch</span> (objectKind) &#123;</span><br><span class="line">                <span class="keyword">case</span> OBJECT:</span><br><span class="line">                    globalObjects.put(name, <span class="built_in">new</span> GraphQLObject(object));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> INTERFACE:</span><br><span class="line">                    globalObjects.put(name, <span class="built_in">new</span> GraphQLInterface(object));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> SCALAR:</span><br><span class="line">                    globalObjects.put(name, <span class="built_in">new</span> GraphQLScalar(name));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> ENUM:</span><br><span class="line">                    globalObjects.put(name, <span class="built_in">new</span> GraphQLEnum(object));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> UNION:</span><br><span class="line">                    globalObjects.put(name, <span class="built_in">new</span> GraphQLUnion(object));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> INPUT_OBJECT:</span><br><span class="line">                    globalObjects.put(name, <span class="built_in">new</span> GraphQLInputObject(object));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    System.out.<span class="built_in">println</span>(objectKind);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GraphQLObject --ã€‹ GraphQLObjectField --ã€‹GraphQLObjectFieldArgument --ã€‹GraphQLObjectType</span><br><span class="line">GraphQLInterface --ã€‹GraphQLObjectField --ã€‹GraphQLObjectType</span><br><span class="line">SCALAR --ã€‹GraphQLScalar --ã€‹</span><br><span class="line">GraphQLEnum--ã€‹</span><br><span class="line">GraphQLUnion --ã€‹GraphQLObjectType</span><br><span class="line">GraphQLInputObject --ã€‹GraphQLInputObjectField --ã€‹GraphQLObjectType</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="Kind-OBJECTç±»å‹"><a href="#Kind-OBJECTç±»å‹" class="headerlink" title="Kind:OBJECTç±»å‹"></a>Kind:OBJECTç±»å‹</h6><p>1.æ·±å…¥åˆ°typeå­—æ®µä¸‹å¯çŸ¥ï¼Œå…·ä½“çš„objectç±»å‹æ•°æ®æ ¼å¼å¤§è‡´å¦‚ä¸‹ï¼Œä¸»è¦å†…å®¹éƒ½åœ¨fieldså­—æ®µ</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">                    <span class="string">&quot;kind&quot;</span>: <span class="string">&quot;OBJECT&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;DataTag&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;description&quot;</span>: null,</span><br><span class="line">                    <span class="string">&quot;fields&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;tag&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;description&quot;</span>: null,</span><br><span class="line">                            <span class="string">&quot;args&quot;</span>: [],</span><br><span class="line">                            <span class="string">&quot;type&quot;</span>: &#123;</span><br><span class="line">                                <span class="string">&quot;kind&quot;</span>: <span class="string">&quot;NON_NULL&quot;</span>,</span><br><span class="line">                                <span class="string">&quot;name&quot;</span>: null,</span><br><span class="line">                                <span class="string">&quot;ofType&quot;</span>: &#123;</span><br><span class="line">                                    <span class="string">&quot;kind&quot;</span>: <span class="string">&quot;SCALAR&quot;</span>,</span><br><span class="line">                                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;String&quot;</span>,</span><br><span class="line">                                    <span class="string">&quot;ofType&quot;</span>: null</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;,</span><br><span class="line">                            <span class="string">&quot;isDeprecated&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                            <span class="string">&quot;deprecationReason&quot;</span>: null</span><br><span class="line">                        &#125; ã€‚ã€‚ã€‚</span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">&quot;inputFields&quot;</span>: null,</span><br><span class="line">                    <span class="string">&quot;interfaces&quot;</span>: [],</span><br><span class="line">                    <span class="string">&quot;enumValues&quot;</span>: null,</span><br><span class="line">                    <span class="string">&quot;possibleTypes&quot;</span>: null</span><br><span class="line">                &#125;,</span><br></pre></td></tr></table></figure>

<p>2.å…ˆå°†jsonä¸­æå–fields å­—æ®µå†…å®¹ï¼Œç„¶åGraphQLObjectFieldArgumentè§£æargså­—æ®µï¼ŒGraphQLObjectTypeè§£ætypeç±»å‹å€¼</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># src/main/java/burp/application/apitypes/graphql/GraphQLObject.java</span><br><span class="line">public GraphQLObject(JsonObject inputJson) &#123;</span><br><span class="line">        super(inputJson);</span><br><span class="line">        this.kind = GraphQLKind.OBJECT;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (JsonElement jsonElement : inputJson.getAsJsonArray(<span class="string">&quot;fields&quot;</span>)) &#123;</span><br><span class="line">            this.fields.add(<span class="built_in">new</span> GraphQLObjectField(jsonElement.getAsJsonObject()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"># src/main/java/burp/application/apitypes/graphql/GraphQLObjectField.java </span><br><span class="line">public GraphQLObjectField(JsonObject inputJson) &#123;</span><br><span class="line">        super(inputJson);</span><br><span class="line">        this.kind = GraphQLKind.OBJECT_FIELD;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (JsonElement jsonElement : inputJson.getAsJsonArray(<span class="string">&quot;args&quot;</span>)) &#123;</span><br><span class="line">            this.args.add(<span class="built_in">new</span> GraphQLObjectFieldArgument(jsonElement.getAsJsonObject()));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        this.<span class="keyword">type</span> = <span class="built_in">new</span> GraphQLObjectType(inputJson.getAsJsonObject(<span class="string">&quot;type&quot;</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>3.ä»”ç»†çœ‹ä¸‹jsonä¸­è¿™éƒ¨åˆ†å€¼ï¼Œkind: â€œNON_NULLâ€è¡¨ç¤ºæ­¤å‚æ•°ä¸å¯ä¸ºç©ºï¼Œç„¶åé€šè¿‡ofTypeæ¥è¡¨æ˜å…·ä½“è¦å†™å•¥æ ·çš„å‚æ•°ï¼Œ</p>
<p>å…¶ä¸­è¿™é‡Œçš„ <code>kind: &quot;SCALAR&quot;</code> è¡¨ç¤ºè¿™ä¸ªå­—æ®µçš„åŸºæœ¬ç±»å‹æ˜¯ä¸€ä¸ªæ ‡é‡ç±»å‹ï¼ˆå³åŸºç¡€ç±»å‹ï¼‰ã€‚ </p>
<p><code>name: &quot;String&quot;</code> è¡¨ç¤ºè¿™ä¸ªå­—æ®µçš„ç±»å‹æ˜¯ <code>String</code> ç±»å‹ã€‚<code>String</code> æ˜¯ GraphQL ä¸­çš„ä¸€ä¸ªæ ‡å‡†æ ‡é‡ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºæ–‡æœ¬æ•°æ®ã€‚</p>
<p>ofTypeâ€: nullä»£è¡¨æ²¡æœ‰å¤åˆç±»å‹äº†ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;type&quot;</span>: &#123;</span><br><span class="line">                               <span class="string">&quot;kind&quot;</span>: <span class="string">&quot;NON_NULL&quot;</span>,</span><br><span class="line">                               <span class="string">&quot;name&quot;</span>: null,</span><br><span class="line">                               <span class="string">&quot;ofType&quot;</span>: &#123;</span><br><span class="line">                                   <span class="string">&quot;kind&quot;</span>: <span class="string">&quot;SCALAR&quot;</span>,</span><br><span class="line">                                   <span class="string">&quot;name&quot;</span>: <span class="string">&quot;String&quot;</span>,</span><br><span class="line">                                   <span class="string">&quot;ofType&quot;</span>: null</span><br><span class="line">                               &#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨apikité‡Œè¿™éƒ¨åˆ†ä¹Ÿæœ‰å¤„ç†é€»è¾‘ï¼Œå¦‚æœraphQLKindç±»å‹ä¸ºGraphQLKind.NON_NULLå’ŒGraphQLKind.LIST é‚£ä¹ˆå°±ä¼šè§£æofTypeå­—æ®µï¼Œçœ‹å…·ä½“è¦é‚£ç§æ ¼å¼çš„å€¼ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># src/main/java/burp/application/apitypes/graphql/GraphQLObjectType.java </span><br><span class="line">public GraphQLObjectType(JsonObject jsonInput) &#123;</span><br><span class="line">        while (<span class="literal">true</span>) &#123;</span><br><span class="line">            GraphQLKind graphQLKind = GraphQLKind.valueOf(jsonInput.getAsJsonPrimitive(<span class="string">&quot;kind&quot;</span>).getAsString());</span><br><span class="line">            <span class="keyword">if</span> (graphQLKind == GraphQLKind.NON_NULL || graphQLKind == GraphQLKind.LIST) &#123;</span><br><span class="line">                modifiers.add(graphQLKind);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                this.kind = graphQLKind;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            jsonInput = jsonInput.getAsJsonObject(<span class="string">&quot;ofType&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        this.typeName = jsonInput.getAsJsonPrimitive(<span class="string">&quot;name&quot;</span>).getAsString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h6 id="Kind-INTERFACEç±»å‹"><a href="#Kind-INTERFACEç±»å‹" class="headerlink" title="Kind:INTERFACEç±»å‹"></a>Kind:INTERFACEç±»å‹</h6><p>1.å…·ä½“çš„INTERFACEç±»å‹æ•°æ®æ ¼å¼å¤§è‡´å¦‚ä¸‹ï¼Œä¸»è¦å†…å®¹éƒ½åœ¨fieldså­—æ®µ</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">                   <span class="string">&quot;kind&quot;</span>: <span class="string">&quot;INTERFACE&quot;</span>,</span><br><span class="line">                   <span class="string">&quot;name&quot;</span>: <span class="string">&quot;UserSignUpInterface&quot;</span>,</span><br><span class="line">                   <span class="string">&quot;description&quot;</span>: null,</span><br><span class="line">                   <span class="string">&quot;fields&quot;</span>: [</span><br><span class="line">                       &#123;</span><br><span class="line">                           <span class="string">&quot;name&quot;</span>: <span class="string">&quot;email&quot;</span>,</span><br><span class="line">                           <span class="string">&quot;description&quot;</span>: null,</span><br><span class="line">                           <span class="string">&quot;args&quot;</span>: [],</span><br><span class="line">                           <span class="string">&quot;type&quot;</span>: &#123;</span><br><span class="line">                               <span class="string">&quot;kind&quot;</span>: <span class="string">&quot;NON_NULL&quot;</span>,</span><br><span class="line">                               <span class="string">&quot;name&quot;</span>: null,</span><br><span class="line">                               <span class="string">&quot;ofType&quot;</span>: &#123;</span><br><span class="line">                                   <span class="string">&quot;kind&quot;</span>: <span class="string">&quot;SCALAR&quot;</span>,</span><br><span class="line">                                   <span class="string">&quot;name&quot;</span>: <span class="string">&quot;String&quot;</span>,</span><br><span class="line">                                   <span class="string">&quot;ofType&quot;</span>: null</span><br><span class="line">                               &#125;</span><br><span class="line">                           &#125;,</span><br><span class="line">                           <span class="string">&quot;isDeprecated&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                           <span class="string">&quot;deprecationReason&quot;</span>: null</span><br><span class="line">                       &#125;</span><br><span class="line">                   ],</span><br><span class="line">                   <span class="string">&quot;inputFields&quot;</span>: null,</span><br><span class="line">                   <span class="string">&quot;interfaces&quot;</span>: [],</span><br><span class="line">                   <span class="string">&quot;enumValues&quot;</span>: null,</span><br><span class="line">                   <span class="string">&quot;possibleTypes&quot;</span>: [</span><br><span class="line">                       &#123;</span><br><span class="line">                           <span class="string">&quot;kind&quot;</span>: <span class="string">&quot;OBJECT&quot;</span>,</span><br><span class="line">                           <span class="string">&quot;name&quot;</span>: <span class="string">&quot;UserSignUpActivationEmailSent&quot;</span>,</span><br><span class="line">                           <span class="string">&quot;ofType&quot;</span>: null</span><br><span class="line">                       &#125;,</span><br><span class="line">                   ]</span><br><span class="line">               &#125;,</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>ä¹Ÿæ˜¯å¤„ç†å­—æ®µï¼ŒåŒºåˆ«åœ¨æœ‰äº†possibleTypeså­—æ®µ,ä½†æ˜¯æ¥ä¸‹æ¥è§£æå­—æ®µå’Œç±»å‹ç”¨çš„å‡½æ•°ä¸€æ ·</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public GraphQLInterface(JsonObject inputJson) &#123;</span><br><span class="line">       super(inputJson);</span><br><span class="line">       this.kind = GraphQLKind.INTERFACE;</span><br><span class="line">   </span><br><span class="line">       <span class="keyword">for</span> (JsonElement jsonElement : inputJson.getAsJsonArray(<span class="string">&quot;fields&quot;</span>)) &#123;</span><br><span class="line">           this.fields.add(<span class="built_in">new</span> GraphQLObjectField(jsonElement.getAsJsonObject()));</span><br><span class="line">       &#125;</span><br><span class="line">   </span><br><span class="line">       <span class="keyword">for</span> (JsonElement jsonElement : inputJson.getAsJsonArray(<span class="string">&quot;possibleTypes&quot;</span>)) &#123;</span><br><span class="line">           this.possibleTypes.add(<span class="built_in">new</span> GraphQLObjectType(jsonElement.getAsJsonObject()));</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="1-4-4-æ¨¡æ‹Ÿè¯·æ±‚-å‘åŒ…"><a href="#1-4-4-æ¨¡æ‹Ÿè¯·æ±‚-å‘åŒ…" class="headerlink" title="1.4.4 æ¨¡æ‹Ÿè¯·æ±‚&#x2F;å‘åŒ…"></a>1.4.4 æ¨¡æ‹Ÿè¯·æ±‚&#x2F;å‘åŒ…</h5><p>æ¨¡æ‹Ÿè¯·æ±‚éƒ¨åˆ†ï¼Œä¸»è¦æ˜¯ç”¨äº†ä¸€ä¸ªæ¥å£ï¼Œåˆ†åˆ«å®ç°äº†Objectã€Interfaceç­‰typeç±»å‹æ—¶ï¼Œè¯¥æ¨¡æ‹Ÿé‚£äº›å‚æ•°ï¼Œfield.exportToQuery(context) è¦†å†™äº†å„ç§ç±»å‹ä¸‹ï¼Œå¯¹äºå†…å®¹çš„å¤„ç†ï¼Œæœ€åè¿”å›è¦æ¨¡æ‹ŸæŸ¥è¯¢æ—¶çš„è¯­å¥</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">GraphQLParseResult parseIntrospection(String introspectionJson) &#123;</span><br><span class="line">     <span class="comment">// é€šè¿‡ QueryName, MutationName å¾—åˆ°å®é™…çš„æ¥å£</span></span><br><span class="line">        JsonElement queryTypeJson = introspection.get(<span class="string">&quot;queryType&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!queryTypeJson.isJsonNull()) &#123;</span><br><span class="line">            String queryTypeName = queryTypeJson.getAsJsonObject().getAsJsonPrimitive(<span class="string">&quot;name&quot;</span>).getAsString();</span><br><span class="line">            GraphQLObject queryObject = (GraphQLObject) globalObjects.get(queryTypeName);</span><br><span class="line">            <span class="keyword">for</span> (GraphQLObjectField field : queryObject.fields) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    parseResult.queryParseResult.put(field.name, context.getExportQueryIndent() + field.exportToQuery(context));</span><br><span class="line">                &#125; catch (GraphQLParseError e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">æ¯”å¦‚ # src/main/java/burp/application/apitypes/graphql/GraphQLScalar.java å°±æ˜¯queryä¸‹å‚æ•°scalaræ—¶ï¼Œæ¨¡æ‹Ÿçš„å®ç°</span><br><span class="line"> public String exportToQuery(GraphQLParseContext context) throws GraphQLParseError &#123;</span><br><span class="line">        String result = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (scalarDefaultValues.containsKey(this.typeName)) &#123;</span><br><span class="line">            result = scalarDefaultValues.get(this.typeName);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// throw new GraphQLParseError(&quot;Unexpected scalar type &quot; + this.typeName);</span></span><br><span class="line">            result = String.format(<span class="string">&quot;\&quot;undefined scalar type %s\&quot;&quot;</span>, this.typeName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¾¹è¿”å›ç»“æœæ•°æ®ç»è¿‡å¤„ç†åä¸ºæ•°æ®ï¼Œæ¯ä¸€æ¡éƒ½å«æœ‰æ–‡æ¡£ä¸­çš„&lt;name,æ¨¡æ‹Ÿå‘é€è¯·æ±‚æ•°æ®&gt;ï¼Œç„¶åéå†å‘é€ã€‚å…¶ä¸­graphQL URLéƒ½æ˜¯ä¸€è‡´çš„ï¼Œåªæ˜¯æ¯æ¬¡bodyå˜æ¢ä¸åŒï¼Œå‘é€å³å¯</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">src/main/java/burp/application/apitypes/graphql/ApiTypeGraphQL.java</span><br><span class="line">public ArrayList&lt;ApiEndpoint&gt; parseApiDocument(IHttpRequestResponse apiDocument, IHttpRequestResponse basePath, boolean isTargetScan) &#123; </span><br><span class="line">endpoints = parseResult.mutationParseResult.entrySet();</span><br><span class="line">        var8 = endpoints.iterator();</span><br><span class="line"></span><br><span class="line">        while(var8.hasNext()) &#123;</span><br><span class="line">            endpoint = (Map.Entry)var8.next();</span><br><span class="line">            <span class="keyword">if</span> (basePath == null) &#123;</span><br><span class="line">                url = this.helpers.analyzeRequest(apiDocument).getUrl();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                url = this.helpers.analyzeRequest(basePath).getUrl();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            newRequest = null;</span><br><span class="line"></span><br><span class="line">            try &#123;</span><br><span class="line">                newRequest = this.helpers.buildHttpRequest(<span class="built_in">new</span> URL(url.toString()));</span><br><span class="line">            &#125; catch (MalformedURLException var16) &#123;</span><br><span class="line">                throw <span class="built_in">new</span> ApiKitRuntimeException(var16);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (basePath == null) &#123;</span><br><span class="line">                newRequest = CookieManager.getRequest(apiDocument, newRequest);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                newRequest = CookieManager.getRequest(basePath, newRequest);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            headers = this.helpers.analyzeRequest(newRequest).getHeaders();</span><br><span class="line">            httpFirstLine = Arrays.asList(((String)headers.get(<span class="number">0</span>)).split(<span class="string">&quot; &quot;</span>));</span><br><span class="line">            httpFirstLine.set(<span class="number">0</span>, <span class="string">&quot;POST&quot;</span>);</span><br><span class="line">            headers.set(<span class="number">0</span>, String.join(<span class="string">&quot; &quot;</span>, httpFirstLine));</span><br><span class="line">            headers.add(<span class="string">&quot;Content-Type: application/json&quot;</span>);</span><br><span class="line">            jsonBody = <span class="built_in">new</span> JsonObject();</span><br><span class="line">            jsonBody.add(<span class="string">&quot;query&quot;</span>, <span class="built_in">new</span> JsonPrimitive(<span class="string">&quot;mutation&quot;</span> + Constants.GRAPHQL_SPACE + (String)endpoint.getKey() + Constants.GRAPHQL_SPACE + <span class="string">&quot;&#123;&quot;</span> + Constants.GRAPHQL_NEW_LINE + (String)endpoint.getValue() + Constants.GRAPHQL_NEW_LINE + <span class="string">&quot;&#125;&quot;</span>));</span><br><span class="line">            <span class="keyword">if</span> (isTargetScan) &#123;</span><br><span class="line">                HttpRequestFormator.TrimDupHeader(headers);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            newRequest = this.helpers.buildHttpMessage(headers, (<span class="built_in">new</span> Gson()).toJson(jsonBody).getBytes());</span><br><span class="line">            <span class="keyword">if</span> (basePath == null) &#123;</span><br><span class="line">                newRequest = CookieManager.getRequest(apiDocument, newRequest);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                newRequest = CookieManager.getRequest(basePath, newRequest);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            tempRequestResponse = <span class="built_in">new</span> HttpRequestResponse();</span><br><span class="line">            <span class="keyword">if</span> (basePath == null) &#123;</span><br><span class="line">                tempRequestResponse.setHttpService(apiDocument.getHttpService());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                tempRequestResponse.setHttpService(basePath.getHttpService());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            tempRequestResponse.setRequest(newRequest);</span><br><span class="line">            tempRequestResponse.sendRequest();</span><br><span class="line">            results.add(<span class="built_in">new</span> ApiEndpoint(<span class="string">&quot;mutation:&quot;</span> + Constants.GRAPHQL_SPACE + (String)endpoint.getKey(), tempRequestResponse));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> results;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="1-4-4-æµ‹è¯•æ•ˆæœ"><a href="#1-4-4-æµ‹è¯•æ•ˆæœ" class="headerlink" title="1.4.4 æµ‹è¯•æ•ˆæœ"></a>1.4.4 æµ‹è¯•æ•ˆæœ</h4><p>1.æµ‹è¯•ä¸­å‘ç°æ•°æ®é‡è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œå› ä¸ºè¿™ä¸ªæ¶‰åŠåˆ°å•URLï¼Œé‡å¤å‘é€bodyä¸åŒçš„åŒ…ï¼Œå¯èƒ½ä¼šæœ‰ç½‘ç»œè¯·æ±‚é—®é¢˜ã€‚</p>
<p>2.æ¨¡æ‹Ÿçš„bodyæ˜¯ä»¥Objectå’ŒInterfaceè¿™ç§ç±»å‹çš„æ¨¡æ‹Ÿæˆæ•°æ®ä¸ºä¸»ï¼Œå‚æ•°æ˜¯ä»¥ â€œkindâ€: â€œNON_NULLâ€,ä¸ºä¸»æµè¿›è¡Œæ¨¡æ‹Ÿçš„</p>
<h4 id="1-5-1-REST-WADL"><a href="#1-5-1-REST-WADL" class="headerlink" title="1.5.1  REST-WADL"></a>1.5.1  REST-WADL</h4><p>WADLï¼ˆWeb Application Description Languageï¼ŒWeb åº”ç”¨æè¿°è¯­è¨€ï¼‰æ˜¯ä¸€ç§åŸºäº XML çš„æ ¼å¼ï¼Œç”¨äºæè¿° RESTful Web æœåŠ¡çš„ APIã€‚å®ƒç±»ä¼¼äº WSDLï¼ˆWeb Services Description Languageï¼‰ï¼Œä½† WSDL ä¸»è¦ç”¨äº SOAPï¼Œè€Œ WADL ä¸»è¦ç”¨äº RESTã€‚</p>
<p>WADL ä¸»è¦ä½œç”¨<br>æè¿° REST APIï¼šæä¾› API çš„ç«¯ç‚¹ã€è¯·æ±‚æ–¹æ³•ï¼ˆGETã€POST ç­‰ï¼‰ã€è¯·æ±‚&#x2F;å“åº”çš„å‚æ•°æ ¼å¼ç­‰ä¿¡æ¯ã€‚<br>è‡ªåŠ¨ç”Ÿæˆå®¢æˆ·ç«¯ä»£ç ï¼šå¯ä»¥åŸºäº WADL æ–‡ä»¶ç”Ÿæˆ API å®¢æˆ·ç«¯ä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚<br>æé«˜ API æ–‡æ¡£åŒ–ï¼šè®©å¼€å‘è€…å¯ä»¥æ›´æ¸…æ™°åœ°äº†è§£ API çš„ç»“æ„.</p>
<h4 id="1-5-2-ç‰¹å¾åŒ¹é…"><a href="#1-5-2-ç‰¹å¾åŒ¹é…" class="headerlink" title="1.5.2 ç‰¹å¾åŒ¹é…"></a>1.5.2 ç‰¹å¾åŒ¹é…</h4><p>åŒæ ·è¿›æ¥çš„ç›®æ ‡ å…ˆé€šè¿‡ isFingerprintMatch()è¿‡æ»¤å­˜æ´»çš„ç‰¹å¾urlè·¯å¾„ï¼Œè·¯å¾„å¤§è‡´ä¸soapæ£€æµ‹çš„wsdlé£æ ¼urlç›¸ä¼¼ï¼Œç„¶åè¿›å…¥urlAddPathè¿›è¡Œç‰¹å¾è§£æ,ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># src/main/java/burp/application/apitypes/rest/ApiTypeRest.java</span><br><span class="line">public Boolean isFingerprintMatch() &#123;</span><br><span class="line">        URL url = this.helpers.analyzeRequest(this.baseRequestResponse).getUrl();</span><br><span class="line">        ArrayList&lt;Object&gt; urlList = <span class="built_in">new</span> ArrayList();</span><br><span class="line">        Set&lt;String&gt; UrlPathList = CommonUtils.getUrlPathList(url);</span><br><span class="line">        Iterator iterator = UrlPathList.iterator();</span><br><span class="line"></span><br><span class="line">        while(<span class="literal">true</span>) &#123;</span><br><span class="line">            String tmpurl;</span><br><span class="line">            do &#123;</span><br><span class="line">                <span class="keyword">if</span> (!iterator.hasNext()) &#123;</span><br><span class="line">                    this.urlAddPath(url.toString());</span><br><span class="line">                    Iterator var6 = urlList.iterator();</span><br><span class="line"></span><br><span class="line">                    while(var6.hasNext()) &#123;</span><br><span class="line">                        Object urlPath = var6.next();</span><br><span class="line">                        <span class="keyword">if</span> (!this.urlAddPath(urlPath + <span class="string">&quot;/service&quot;</span>)) &#123;</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/services&quot;</span>);</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/webservices&quot;</span>);</span><br><span class="line">                            this.urlAddPath(urlPath + <span class="string">&quot;/webservice&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> this.getApiDocuments().size() != <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                tmpurl = iterator.next().toString();</span><br><span class="line">            &#125; while(scannedUrl.get(tmpurl) &gt; <span class="number">0</span> &amp;&amp; this.isPassive);</span><br><span class="line"></span><br><span class="line">            urlList.add(tmpurl);</span><br><span class="line">            <span class="keyword">if</span> (this.isPassive) &#123;</span><br><span class="line">                scannedUrl.add(tmpurl);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="urlAddPathä¸»è¦åšç‰¹å¾åŒ¹é…-æ­£åˆ™urlè§£æç½‘é¡µå“åº”æµé‡ä¸­æ˜¯å¦å­˜åœ¨wadlç½‘é¡µï¼Œæˆ–è€…å‡ºç°"><a href="#urlAddPathä¸»è¦åšç‰¹å¾åŒ¹é…-æ­£åˆ™urlè§£æç½‘é¡µå“åº”æµé‡ä¸­æ˜¯å¦å­˜åœ¨wadlç½‘é¡µï¼Œæˆ–è€…å‡ºç°" class="headerlink" title="urlAddPathä¸»è¦åšç‰¹å¾åŒ¹é… æ­£åˆ™urlè§£æç½‘é¡µå“åº”æµé‡ä¸­æ˜¯å¦å­˜åœ¨wadlç½‘é¡µï¼Œæˆ–è€…å‡ºç°&lt;application å¯èƒ½æ˜¯ç½‘é¡µæœ¬èº«å°±æ˜¯wadlæ–‡æ¡£"></a>urlAddPathä¸»è¦åšç‰¹å¾åŒ¹é… æ­£åˆ™urlè§£æç½‘é¡µå“åº”æµé‡ä¸­æ˜¯å¦å­˜åœ¨wadlç½‘é¡µï¼Œæˆ–è€…å‡ºç°&lt;application å¯èƒ½æ˜¯ç½‘é¡µæœ¬èº«å°±æ˜¯wadlæ–‡æ¡£</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># src/main/java/burp/application/apitypes/rest/ApiTypeRest.java</span><br><span class="line">public Boolean urlAddPath(String apiDocumentUrl) &#123;</span><br><span class="line">      String resp = <span class="built_in">new</span> String(CommonUtils.getHttpResponseBody(newHttpRequestResponse.getResponse()));</span><br><span class="line">            <span class="keyword">if</span> (resp.contains(<span class="string">&quot;&lt;application&quot;</span>) &amp;&amp; resp.contains(<span class="string">&quot;&lt;resources&quot;</span>)) &#123;</span><br><span class="line">                this.getApiDocuments().put(apiDocumentUrl, newHttpRequestResponse);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Pattern pattern = Pattern.compile(<span class="string">&quot;href=\&quot;([^\&quot;]*\\?_?wadl)\&quot;&gt;&quot;</span>);</span><br><span class="line">                Matcher matcher = pattern.matcher(resp);</span><br><span class="line">                Boolean isFound = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">                while(matcher.find()) &#123;</span><br><span class="line">                    isFound = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                    try &#123;</span><br><span class="line">                        String apidocument = matcher.group(<span class="number">1</span>);</span><br><span class="line">                        <span class="keyword">if</span> (!this.getApiDocuments().containsKey(apidocument)) &#123;</span><br><span class="line">                            newRequest = this.helpers.buildHttpRequest(<span class="built_in">new</span> URL(apidocument));</span><br><span class="line">                            IHttpRequestResponse tempRequestResponse = CookieManager.makeHttpRequest(this.baseRequestResponse, newRequest);</span><br><span class="line">                            this.getApiDocuments().put(apidocument, tempRequestResponse);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; catch (Exception var13) &#123;</span><br><span class="line">                    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-5-2æ–‡æ¡£è§£æ"><a href="#1-5-2æ–‡æ¡£è§£æ" class="headerlink" title="1.5.2æ–‡æ¡£è§£æ"></a>1.5.2æ–‡æ¡£è§£æ</h4><p>å› ä¸ºwadlé£æ ¼æ˜¯restful APIæ ¼å¼çš„è§£ææ¯”è¾ƒå®¹æ˜“ï¼ŒparseWadlä¸»è¦æ¥è§£æå†…å®¹ä¸­çš„apiåœ°å€</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"># src/main/java/burp/application/apitypes/rest/WadlParser.java</span><br><span class="line">public HashMap&lt;List&lt;String&gt;, <span class="type">byte</span>[]&gt; parseWadl(IHttpRequestResponse apiDocument, IHttpRequestResponse basePath) &#123;</span><br><span class="line">        IExtensionHelpers helpers = BurpExtender.getHelpers();</span><br><span class="line">    ã€‚ã€‚ã€‚</span><br><span class="line">        while(<span class="literal">true</span>) &#123;</span><br><span class="line">            List methods;</span><br><span class="line">            Resource resource;</span><br><span class="line">            do &#123;</span><br><span class="line">                <span class="keyword">if</span> (queue.size() == <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> this.apiRequestResponse;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                resource = (Resource)queue.get(<span class="number">0</span>);</span><br><span class="line">                List&lt;Resource&gt; tmpResources = resource.getResources();</span><br><span class="line">                <span class="keyword">if</span> (tmpResources.size() != <span class="number">0</span>) &#123;</span><br><span class="line">                    queue.addAll(tmpResources);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                queue.remove(<span class="number">0</span>);</span><br><span class="line">                <span class="type">byte</span>[] apiRequest = null;</span><br><span class="line">                methods = resource.getMethods();</span><br><span class="line">            &#125; while(methods.size() == <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            Iterator var13 = methods.iterator();</span><br><span class="line"></span><br><span class="line">            while(var13.hasNext()) &#123;</span><br><span class="line">               ã€‚ã€‚ã€‚</span><br><span class="line">                this.getParentParametersandPath(resource);</span><br><span class="line">                this.path = this.path.replaceAll(<span class="string">&quot;//&quot;</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (this.path.startsWith(<span class="string">&quot;/&quot;</span>)) &#123;</span><br><span class="line">                    this.path = this.path.replaceFirst(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (this.path.endsWith(<span class="string">&quot;/&quot;</span>)) &#123;</span><br><span class="line">                    this.path = this.path.substring(<span class="number">0</span>, this.path.length() - <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (method.getRequest() != null) &#123;</span><br><span class="line">                    Iterator var22 = method.getRequest().getParams().iterator();</span><br><span class="line"></span><br><span class="line">                    while(var22.hasNext()) &#123;</span><br><span class="line">                        Param param = (Param)var22.next();</span><br><span class="line">                        this.addParameter(param);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">				</span><br><span class="line">                this.buildHttpRequestParams();</span><br><span class="line">                this.saveHttpRequest();</span><br><span class="line">                this.clearCache();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è·Ÿè¿›å this.buildHttpRequestParams(); ä¼šä¸ºæ¨¡æ‹Ÿè¯·æ±‚è¿›è¡Œå‡†å¤‡ï¼ŒåŒ…æ‹¬è®¾ç½®æ–‡ä»¶å¤´ï¼Œä»¥åŠè®¾ç½®è¯·æ±‚å‚æ•°ï¼Œå‘é€è¯·æ±‚ç±»å‹å¤´æ˜¯jsonæ ¼å¼è¿˜æ˜¯xmlæ ¼å¼éƒ½ä¼šè¿›è¡Œå¤„ç†ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"> # src/main/java/burp/application/apitypes/rest/WadlParser.java</span><br><span class="line">public void buildHttpRequestParams() &#123;</span><br><span class="line">        Set matrix;</span><br><span class="line">        Iterator var2;</span><br><span class="line">        Map.Entry entry;</span><br><span class="line">        String paramName;</span><br><span class="line">        String paramValue;</span><br><span class="line">        <span class="keyword">if</span> (((HashMap)this.params.get(<span class="string">&quot;template&quot;</span>)).size() != <span class="number">0</span>) &#123;</span><br><span class="line">            matrix = ((HashMap)this.params.get(<span class="string">&quot;template&quot;</span>)).entrySet();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(var2 = matrix.iterator(); var2.hasNext(); this.path = this.path.replace(<span class="string">&quot;&#123;&quot;</span> + paramName + <span class="string">&quot;&#125;&quot;</span>, paramValue)) &#123;</span><br><span class="line">                entry = (Map.Entry)var2.next();</span><br><span class="line">                paramName = (String)entry.getKey();</span><br><span class="line">                paramValue = mockData(<span class="string">&quot;+&quot;</span> + entry.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (((HashMap)this.params.get(<span class="string">&quot;query&quot;</span>)).size() != <span class="number">0</span>) &#123;</span><br><span class="line">            matrix = ((HashMap)this.params.get(<span class="string">&quot;query&quot;</span>)).entrySet();</span><br><span class="line">            var2 = matrix.iterator();</span><br><span class="line"></span><br><span class="line">            while(var2.hasNext()) &#123;</span><br><span class="line">                entry = (Map.Entry)var2.next();</span><br><span class="line">                paramName = (String)entry.getKey();</span><br><span class="line">                paramValue = mockData((String)entry.getValue());</span><br><span class="line">                <span class="keyword">switch</span> (this.content_type) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;&quot;</span>:</span><br><span class="line">                        this.para_querystr = this.para_querystr + String.format(<span class="string">&quot;&amp;%s=%s&quot;</span>, paramName, paramValue);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;application/json&quot;</span>:</span><br><span class="line">                        this.para_bodystr = this.para_bodystr + <span class="string">&quot;\&quot;&quot;</span> + paramName + <span class="string">&quot;\&quot;: \&quot;&quot;</span> + paramValue + <span class="string">&quot;\&quot;,&quot;</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;application/xml&quot;</span>:</span><br><span class="line">                        this.para_bodystr = <span class="string">&quot;&lt;?xml&gt;&quot;</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>:</span><br><span class="line">                        this.para_bodystr = this.para_bodystr + String.format(<span class="string">&quot;&amp;%s=%s&quot;</span>, paramName, paramValue);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        this.para_bodystr = <span class="string">&quot;Not Support Media Format&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      ã€‚ã€‚</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ mockData è´Ÿè´£æ ¹æ®æ•°æ®ç±»å‹ï¼Œè¿”å›æ¨¡æ‹Ÿçš„å‡æ•°æ®</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> # src/main/java/burp/application/apitypes/rest/WadlParser.java</span><br><span class="line">public static String mockData(String value) &#123;</span><br><span class="line">        <span class="keyword">if</span> (value.startsWith(<span class="string">&quot;*&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> value.substring(<span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Boolean isRequired = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (value.startsWith(<span class="string">&quot;+&quot;</span>)) &#123;</span><br><span class="line">                isRequired = <span class="literal">true</span>;</span><br><span class="line">                value = value.substring(<span class="number">1</span>).toLowerCase(Locale.ROOT);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">switch</span> (value) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;string&quot;</span>:</span><br><span class="line">                    value = value.replace(value, <span class="string">&quot;testString&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;int&quot;</span>:</span><br><span class="line">                    value = value.replace(value, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    value = isRequired ? <span class="string">&quot;&#123;RequiredValue:\t&quot;</span> + value + <span class="string">&quot;&#125;&quot;</span> : <span class="string">&quot;[OptionalValue\t&quot;</span> + value + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>





<p>1.5.4æ ¹æ®åç¼–è¯‘jaråŒ…ï¼Œæ–°ç‰ˆæºç </p>

      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æº. </span>
    </div>
</article>







    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Â©2022-2024
</p>


    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    

    
</style>







</html>
